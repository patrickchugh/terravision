{
    "codepath": "tests/fixtures/aws_terraform/waf_alb",
    "workdir": "/Users/patrick/git/terravision-privatedev",
    "plandata": {
        "format_version": "1.2",
        "terraform_version": "1.13.3",
        "planned_values": {
            "outputs": {
                "alb_dns": {
                    "sensitive": false
                },
                "waf_arn": {
                    "sensitive": false
                },
                "waf_association": {
                    "sensitive": false
                }
            },
            "root_module": {
                "resources": [
                    {
                        "address": "aws_internet_gateway.main",
                        "mode": "managed",
                        "type": "aws_internet_gateway",
                        "name": "main",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "tags": {
                                "Name": "waf-alb-igw"
                            },
                            "tags_all": {
                                "Name": "waf-alb-igw"
                            },
                            "timeouts": null
                        },
                        "sensitive_values": {
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_lb.main",
                        "mode": "managed",
                        "type": "aws_lb",
                        "name": "main",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "access_logs": [],
                            "client_keep_alive": 3600,
                            "connection_logs": [],
                            "customer_owned_ipv4_pool": null,
                            "desync_mitigation_mode": "defensive",
                            "dns_record_client_routing_policy": null,
                            "drop_invalid_header_fields": false,
                            "enable_cross_zone_load_balancing": null,
                            "enable_deletion_protection": false,
                            "enable_http2": true,
                            "enable_tls_version_and_cipher_suite_headers": false,
                            "enable_waf_fail_open": false,
                            "enable_xff_client_port": false,
                            "enable_zonal_shift": false,
                            "idle_timeout": 60,
                            "internal": false,
                            "ipam_pools": [],
                            "load_balancer_type": "application",
                            "minimum_load_balancer_capacity": [],
                            "name": "waf-protected-alb",
                            "preserve_host_header": false,
                            "tags": {
                                "Name": "waf-protected-alb"
                            },
                            "tags_all": {
                                "Name": "waf-protected-alb"
                            },
                            "timeouts": null,
                            "xff_header_processing_mode": "append"
                        },
                        "sensitive_values": {
                            "access_logs": [],
                            "connection_logs": [],
                            "ipam_pools": [],
                            "minimum_load_balancer_capacity": [],
                            "security_groups": [],
                            "subnet_mapping": [],
                            "subnets": [],
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_lb_listener.http",
                        "mode": "managed",
                        "type": "aws_lb_listener",
                        "name": "http",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "alpn_policy": null,
                            "certificate_arn": null,
                            "default_action": [
                                {
                                    "authenticate_cognito": [],
                                    "authenticate_oidc": [],
                                    "fixed_response": [],
                                    "forward": [],
                                    "redirect": [],
                                    "type": "forward"
                                }
                            ],
                            "port": 80,
                            "protocol": "HTTP",
                            "tags": null,
                            "timeouts": null
                        },
                        "sensitive_values": {
                            "default_action": [
                                {
                                    "authenticate_cognito": [],
                                    "authenticate_oidc": [],
                                    "fixed_response": [],
                                    "forward": [],
                                    "redirect": []
                                }
                            ],
                            "mutual_authentication": [],
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_lb_target_group.main",
                        "mode": "managed",
                        "type": "aws_lb_target_group",
                        "name": "main",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "deregistration_delay": "300",
                            "health_check": [
                                {
                                    "enabled": true,
                                    "healthy_threshold": 2,
                                    "interval": 30,
                                    "matcher": "200",
                                    "path": "/",
                                    "port": "traffic-port",
                                    "protocol": "HTTP",
                                    "timeout": 5,
                                    "unhealthy_threshold": 2
                                }
                            ],
                            "lambda_multi_value_headers_enabled": false,
                            "name": "waf-alb-targets",
                            "port": 80,
                            "protocol": "HTTP",
                            "proxy_protocol_v2": false,
                            "slow_start": 0,
                            "tags": {
                                "Name": "waf-alb-targets"
                            },
                            "tags_all": {
                                "Name": "waf-alb-targets"
                            },
                            "target_type": "instance"
                        },
                        "sensitive_values": {
                            "health_check": [
                                {}
                            ],
                            "load_balancer_arns": [],
                            "stickiness": [],
                            "tags": {},
                            "tags_all": {},
                            "target_failover": [],
                            "target_group_health": [],
                            "target_health_state": []
                        }
                    },
                    {
                        "address": "aws_route_table.public",
                        "mode": "managed",
                        "type": "aws_route_table",
                        "name": "public",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "route": [
                                {
                                    "carrier_gateway_id": "",
                                    "cidr_block": "0.0.0.0/0",
                                    "core_network_arn": "",
                                    "destination_prefix_list_id": "",
                                    "egress_only_gateway_id": "",
                                    "ipv6_cidr_block": "",
                                    "local_gateway_id": "",
                                    "nat_gateway_id": "",
                                    "network_interface_id": "",
                                    "transit_gateway_id": "",
                                    "vpc_endpoint_id": "",
                                    "vpc_peering_connection_id": ""
                                }
                            ],
                            "tags": {
                                "Name": "waf-alb-public-rt"
                            },
                            "tags_all": {
                                "Name": "waf-alb-public-rt"
                            },
                            "timeouts": null
                        },
                        "sensitive_values": {
                            "propagating_vgws": [],
                            "route": [
                                {}
                            ],
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_route_table_association.public_a",
                        "mode": "managed",
                        "type": "aws_route_table_association",
                        "name": "public_a",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "gateway_id": null,
                            "timeouts": null
                        },
                        "sensitive_values": {}
                    },
                    {
                        "address": "aws_route_table_association.public_b",
                        "mode": "managed",
                        "type": "aws_route_table_association",
                        "name": "public_b",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "gateway_id": null,
                            "timeouts": null
                        },
                        "sensitive_values": {}
                    },
                    {
                        "address": "aws_security_group.alb",
                        "mode": "managed",
                        "type": "aws_security_group",
                        "name": "alb",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 1,
                        "values": {
                            "description": "Security group for ALB with WAF",
                            "egress": [
                                {
                                    "cidr_blocks": [
                                        "0.0.0.0/0"
                                    ],
                                    "description": "All outbound traffic",
                                    "from_port": 0,
                                    "ipv6_cidr_blocks": [],
                                    "prefix_list_ids": [],
                                    "protocol": "-1",
                                    "security_groups": [],
                                    "self": false,
                                    "to_port": 0
                                }
                            ],
                            "ingress": [
                                {
                                    "cidr_blocks": [
                                        "0.0.0.0/0"
                                    ],
                                    "description": "HTTP from anywhere",
                                    "from_port": 80,
                                    "ipv6_cidr_blocks": [],
                                    "prefix_list_ids": [],
                                    "protocol": "tcp",
                                    "security_groups": [],
                                    "self": false,
                                    "to_port": 80
                                },
                                {
                                    "cidr_blocks": [
                                        "0.0.0.0/0"
                                    ],
                                    "description": "HTTPS from anywhere",
                                    "from_port": 443,
                                    "ipv6_cidr_blocks": [],
                                    "prefix_list_ids": [],
                                    "protocol": "tcp",
                                    "security_groups": [],
                                    "self": false,
                                    "to_port": 443
                                }
                            ],
                            "name": "waf-alb-sg",
                            "revoke_rules_on_delete": false,
                            "tags": {
                                "Name": "waf-alb-sg"
                            },
                            "tags_all": {
                                "Name": "waf-alb-sg"
                            },
                            "timeouts": null
                        },
                        "sensitive_values": {
                            "egress": [
                                {
                                    "cidr_blocks": [
                                        false
                                    ],
                                    "ipv6_cidr_blocks": [],
                                    "prefix_list_ids": [],
                                    "security_groups": []
                                }
                            ],
                            "ingress": [
                                {
                                    "cidr_blocks": [
                                        false
                                    ],
                                    "ipv6_cidr_blocks": [],
                                    "prefix_list_ids": [],
                                    "security_groups": []
                                },
                                {
                                    "cidr_blocks": [
                                        false
                                    ],
                                    "ipv6_cidr_blocks": [],
                                    "prefix_list_ids": [],
                                    "security_groups": []
                                }
                            ],
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_subnet.public_a",
                        "mode": "managed",
                        "type": "aws_subnet",
                        "name": "public_a",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 1,
                        "values": {
                            "assign_ipv6_address_on_creation": false,
                            "availability_zone": "us-west-2a",
                            "cidr_block": "10.0.1.0/24",
                            "customer_owned_ipv4_pool": null,
                            "enable_dns64": false,
                            "enable_lni_at_device_index": null,
                            "enable_resource_name_dns_a_record_on_launch": false,
                            "enable_resource_name_dns_aaaa_record_on_launch": false,
                            "ipv6_cidr_block": null,
                            "ipv6_native": false,
                            "map_customer_owned_ip_on_launch": null,
                            "map_public_ip_on_launch": true,
                            "outpost_arn": null,
                            "tags": {
                                "Name": "waf-alb-public-a"
                            },
                            "tags_all": {
                                "Name": "waf-alb-public-a"
                            },
                            "timeouts": null
                        },
                        "sensitive_values": {
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_subnet.public_b",
                        "mode": "managed",
                        "type": "aws_subnet",
                        "name": "public_b",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 1,
                        "values": {
                            "assign_ipv6_address_on_creation": false,
                            "availability_zone": "us-west-2b",
                            "cidr_block": "10.0.2.0/24",
                            "customer_owned_ipv4_pool": null,
                            "enable_dns64": false,
                            "enable_lni_at_device_index": null,
                            "enable_resource_name_dns_a_record_on_launch": false,
                            "enable_resource_name_dns_aaaa_record_on_launch": false,
                            "ipv6_cidr_block": null,
                            "ipv6_native": false,
                            "map_customer_owned_ip_on_launch": null,
                            "map_public_ip_on_launch": true,
                            "outpost_arn": null,
                            "tags": {
                                "Name": "waf-alb-public-b"
                            },
                            "tags_all": {
                                "Name": "waf-alb-public-b"
                            },
                            "timeouts": null
                        },
                        "sensitive_values": {
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_vpc.main",
                        "mode": "managed",
                        "type": "aws_vpc",
                        "name": "main",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 1,
                        "values": {
                            "assign_generated_ipv6_cidr_block": null,
                            "cidr_block": "10.0.0.0/16",
                            "enable_dns_hostnames": true,
                            "enable_dns_support": true,
                            "instance_tenancy": "default",
                            "ipv4_ipam_pool_id": null,
                            "ipv4_netmask_length": null,
                            "ipv6_ipam_pool_id": null,
                            "ipv6_netmask_length": null,
                            "tags": {
                                "Name": "waf-alb-test-vpc"
                            },
                            "tags_all": {
                                "Name": "waf-alb-test-vpc"
                            }
                        },
                        "sensitive_values": {
                            "tags": {},
                            "tags_all": {}
                        }
                    },
                    {
                        "address": "aws_wafv2_web_acl.alb",
                        "mode": "managed",
                        "type": "aws_wafv2_web_acl",
                        "name": "alb",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "association_config": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "custom_response_body": [],
                            "data_protection_config": [],
                            "default_action": [
                                {
                                    "allow": [
                                        {
                                            "custom_request_handling": []
                                        }
                                    ],
                                    "block": []
                                }
                            ],
                            "description": null,
                            "name": "alb-web-acl",
                            "rule": [
                                {
                                    "action": [
                                        {
                                            "allow": [],
                                            "block": [
                                                {
                                                    "custom_response": []
                                                }
                                            ],
                                            "captcha": [],
                                            "challenge": [],
                                            "count": []
                                        }
                                    ],
                                    "captcha_config": [],
                                    "challenge_config": [],
                                    "name": "rate-limit-rule",
                                    "override_action": [],
                                    "priority": 3,
                                    "rule_label": [],
                                    "statement": [
                                        {
                                            "and_statement": [],
                                            "asn_match_statement": [],
                                            "byte_match_statement": [],
                                            "geo_match_statement": [],
                                            "ip_set_reference_statement": [],
                                            "label_match_statement": [],
                                            "managed_rule_group_statement": [],
                                            "not_statement": [],
                                            "or_statement": [],
                                            "rate_based_statement": [
                                                {
                                                    "aggregate_key_type": "IP",
                                                    "custom_key": [],
                                                    "evaluation_window_sec": 300,
                                                    "forwarded_ip_config": [],
                                                    "limit": 1000,
                                                    "scope_down_statement": []
                                                }
                                            ],
                                            "regex_match_statement": [],
                                            "regex_pattern_set_reference_statement": [],
                                            "rule_group_reference_statement": [],
                                            "size_constraint_statement": [],
                                            "sqli_match_statement": [],
                                            "xss_match_statement": []
                                        }
                                    ],
                                    "visibility_config": [
                                        {
                                            "cloudwatch_metrics_enabled": true,
                                            "metric_name": "RateLimitRule",
                                            "sampled_requests_enabled": true
                                        }
                                    ]
                                },
                                {
                                    "action": [],
                                    "captcha_config": [],
                                    "challenge_config": [],
                                    "name": "sql-injection-rule",
                                    "override_action": [
                                        {
                                            "count": [],
                                            "none": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "priority": 1,
                                    "rule_label": [],
                                    "statement": [
                                        {
                                            "and_statement": [],
                                            "asn_match_statement": [],
                                            "byte_match_statement": [],
                                            "geo_match_statement": [],
                                            "ip_set_reference_statement": [],
                                            "label_match_statement": [],
                                            "managed_rule_group_statement": [
                                                {
                                                    "managed_rule_group_configs": [],
                                                    "name": "AWSManagedRulesSQLiRuleSet",
                                                    "rule_action_override": [],
                                                    "scope_down_statement": [],
                                                    "vendor_name": "AWS",
                                                    "version": ""
                                                }
                                            ],
                                            "not_statement": [],
                                            "or_statement": [],
                                            "rate_based_statement": [],
                                            "regex_match_statement": [],
                                            "regex_pattern_set_reference_statement": [],
                                            "rule_group_reference_statement": [],
                                            "size_constraint_statement": [],
                                            "sqli_match_statement": [],
                                            "xss_match_statement": []
                                        }
                                    ],
                                    "visibility_config": [
                                        {
                                            "cloudwatch_metrics_enabled": true,
                                            "metric_name": "SQLInjectionRule",
                                            "sampled_requests_enabled": true
                                        }
                                    ]
                                },
                                {
                                    "action": [],
                                    "captcha_config": [],
                                    "challenge_config": [],
                                    "name": "xss-protection-rule",
                                    "override_action": [
                                        {
                                            "count": [],
                                            "none": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "priority": 2,
                                    "rule_label": [],
                                    "statement": [
                                        {
                                            "and_statement": [],
                                            "asn_match_statement": [],
                                            "byte_match_statement": [],
                                            "geo_match_statement": [],
                                            "ip_set_reference_statement": [],
                                            "label_match_statement": [],
                                            "managed_rule_group_statement": [
                                                {
                                                    "managed_rule_group_configs": [],
                                                    "name": "AWSManagedRulesKnownBadInputsRuleSet",
                                                    "rule_action_override": [],
                                                    "scope_down_statement": [],
                                                    "vendor_name": "AWS",
                                                    "version": ""
                                                }
                                            ],
                                            "not_statement": [],
                                            "or_statement": [],
                                            "rate_based_statement": [],
                                            "regex_match_statement": [],
                                            "regex_pattern_set_reference_statement": [],
                                            "rule_group_reference_statement": [],
                                            "size_constraint_statement": [],
                                            "sqli_match_statement": [],
                                            "xss_match_statement": []
                                        }
                                    ],
                                    "visibility_config": [
                                        {
                                            "cloudwatch_metrics_enabled": true,
                                            "metric_name": "XSSProtectionRule",
                                            "sampled_requests_enabled": true
                                        }
                                    ]
                                }
                            ],
                            "rule_json": null,
                            "scope": "REGIONAL",
                            "tags": {
                                "Name": "alb-web-acl"
                            },
                            "tags_all": {
                                "Name": "alb-web-acl"
                            },
                            "token_domains": null,
                            "visibility_config": [
                                {
                                    "cloudwatch_metrics_enabled": true,
                                    "metric_name": "ALBWebACL",
                                    "sampled_requests_enabled": true
                                }
                            ]
                        },
                        "sensitive_values": {
                            "association_config": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "custom_response_body": [],
                            "data_protection_config": [],
                            "default_action": [
                                {
                                    "allow": [
                                        {
                                            "custom_request_handling": []
                                        }
                                    ],
                                    "block": []
                                }
                            ],
                            "rule": [
                                {
                                    "action": [
                                        {
                                            "allow": [],
                                            "block": [
                                                {
                                                    "custom_response": []
                                                }
                                            ],
                                            "captcha": [],
                                            "challenge": [],
                                            "count": []
                                        }
                                    ],
                                    "captcha_config": [],
                                    "challenge_config": [],
                                    "override_action": [],
                                    "rule_label": [],
                                    "statement": [
                                        {
                                            "and_statement": [],
                                            "asn_match_statement": [],
                                            "byte_match_statement": [],
                                            "geo_match_statement": [],
                                            "ip_set_reference_statement": [],
                                            "label_match_statement": [],
                                            "managed_rule_group_statement": [],
                                            "not_statement": [],
                                            "or_statement": [],
                                            "rate_based_statement": [
                                                {
                                                    "custom_key": [],
                                                    "forwarded_ip_config": [],
                                                    "scope_down_statement": []
                                                }
                                            ],
                                            "regex_match_statement": [],
                                            "regex_pattern_set_reference_statement": [],
                                            "rule_group_reference_statement": [],
                                            "size_constraint_statement": [],
                                            "sqli_match_statement": [],
                                            "xss_match_statement": []
                                        }
                                    ],
                                    "visibility_config": [
                                        {}
                                    ]
                                },
                                {
                                    "action": [],
                                    "captcha_config": [],
                                    "challenge_config": [],
                                    "override_action": [
                                        {
                                            "count": [],
                                            "none": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "rule_label": [],
                                    "statement": [
                                        {
                                            "and_statement": [],
                                            "asn_match_statement": [],
                                            "byte_match_statement": [],
                                            "geo_match_statement": [],
                                            "ip_set_reference_statement": [],
                                            "label_match_statement": [],
                                            "managed_rule_group_statement": [
                                                {
                                                    "managed_rule_group_configs": [],
                                                    "rule_action_override": [],
                                                    "scope_down_statement": []
                                                }
                                            ],
                                            "not_statement": [],
                                            "or_statement": [],
                                            "rate_based_statement": [],
                                            "regex_match_statement": [],
                                            "regex_pattern_set_reference_statement": [],
                                            "rule_group_reference_statement": [],
                                            "size_constraint_statement": [],
                                            "sqli_match_statement": [],
                                            "xss_match_statement": []
                                        }
                                    ],
                                    "visibility_config": [
                                        {}
                                    ]
                                },
                                {
                                    "action": [],
                                    "captcha_config": [],
                                    "challenge_config": [],
                                    "override_action": [
                                        {
                                            "count": [],
                                            "none": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "rule_label": [],
                                    "statement": [
                                        {
                                            "and_statement": [],
                                            "asn_match_statement": [],
                                            "byte_match_statement": [],
                                            "geo_match_statement": [],
                                            "ip_set_reference_statement": [],
                                            "label_match_statement": [],
                                            "managed_rule_group_statement": [
                                                {
                                                    "managed_rule_group_configs": [],
                                                    "rule_action_override": [],
                                                    "scope_down_statement": []
                                                }
                                            ],
                                            "not_statement": [],
                                            "or_statement": [],
                                            "rate_based_statement": [],
                                            "regex_match_statement": [],
                                            "regex_pattern_set_reference_statement": [],
                                            "rule_group_reference_statement": [],
                                            "size_constraint_statement": [],
                                            "sqli_match_statement": [],
                                            "xss_match_statement": []
                                        }
                                    ],
                                    "visibility_config": [
                                        {}
                                    ]
                                }
                            ],
                            "tags": {},
                            "tags_all": {},
                            "visibility_config": [
                                {}
                            ]
                        }
                    },
                    {
                        "address": "aws_wafv2_web_acl_association.alb",
                        "mode": "managed",
                        "type": "aws_wafv2_web_acl_association",
                        "name": "alb",
                        "provider_name": "registry.terraform.io/hashicorp/aws",
                        "schema_version": 0,
                        "values": {
                            "timeouts": null
                        },
                        "sensitive_values": {}
                    }
                ]
            }
        },
        "resource_changes": [
            {
                "address": "aws_internet_gateway.main",
                "mode": "managed",
                "type": "aws_internet_gateway",
                "name": "main",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "tags": {},
                        "tags_all": {},
                        "timeouts": null,
                        "arn": true,
                        "id": true,
                        "owner_id": true,
                        "vpc_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "id": true,
                        "owner_id": true,
                        "tags": {},
                        "tags_all": {},
                        "vpc_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_lb.main",
                "mode": "managed",
                "type": "aws_lb",
                "name": "main",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "access_logs": [],
                        "client_keep_alive": 3600,
                        "connection_logs": [],
                        "customer_owned_ipv4_pool": null,
                        "desync_mitigation_mode": "defensive",
                        "dns_record_client_routing_policy": null,
                        "drop_invalid_header_fields": false,
                        "enable_cross_zone_load_balancing": null,
                        "enable_deletion_protection": false,
                        "enable_http2": true,
                        "enable_tls_version_and_cipher_suite_headers": false,
                        "enable_waf_fail_open": false,
                        "enable_xff_client_port": false,
                        "enable_zonal_shift": false,
                        "idle_timeout": 60,
                        "internal": false,
                        "ipam_pools": [],
                        "load_balancer_type": "application",
                        "minimum_load_balancer_capacity": [],
                        "name": "waf-protected-alb",
                        "preserve_host_header": false,
                        "tags": {},
                        "tags_all": {},
                        "timeouts": null,
                        "xff_header_processing_mode": "append",
                        "arn": true,
                        "arn_suffix": true,
                        "dns_name": true,
                        "enforce_security_group_inbound_rules_on_private_link_traffic": true,
                        "id": true,
                        "ip_address_type": true,
                        "name_prefix": true,
                        "security_groups": [],
                        "subnet_mapping": [],
                        "subnets": [],
                        "vpc_id": true,
                        "zone_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "access_logs": [],
                        "arn": true,
                        "arn_suffix": true,
                        "connection_logs": [],
                        "dns_name": true,
                        "enforce_security_group_inbound_rules_on_private_link_traffic": true,
                        "id": true,
                        "ip_address_type": true,
                        "ipam_pools": [],
                        "minimum_load_balancer_capacity": [],
                        "name_prefix": true,
                        "security_groups": true,
                        "subnet_mapping": true,
                        "subnets": true,
                        "tags": {},
                        "tags_all": {},
                        "vpc_id": true,
                        "zone_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "access_logs": [],
                        "connection_logs": [],
                        "ipam_pools": [],
                        "minimum_load_balancer_capacity": [],
                        "security_groups": [],
                        "subnet_mapping": [],
                        "subnets": [],
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_lb_listener.http",
                "mode": "managed",
                "type": "aws_lb_listener",
                "name": "http",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "alpn_policy": null,
                        "certificate_arn": null,
                        "default_action": [
                            {
                                "authenticate_cognito": [],
                                "authenticate_oidc": [],
                                "fixed_response": [],
                                "forward": [],
                                "redirect": []
                            }
                        ],
                        "port": 80,
                        "protocol": "HTTP",
                        "tags": null,
                        "timeouts": null,
                        "arn": true,
                        "id": true,
                        "load_balancer_arn": true,
                        "mutual_authentication": [],
                        "routing_http_request_x_amzn_mtls_clientcert_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_issuer_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_leaf_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_subject_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_validity_header_name": true,
                        "routing_http_request_x_amzn_tls_cipher_suite_header_name": true,
                        "routing_http_request_x_amzn_tls_version_header_name": true,
                        "routing_http_response_access_control_allow_credentials_header_value": true,
                        "routing_http_response_access_control_allow_headers_header_value": true,
                        "routing_http_response_access_control_allow_methods_header_value": true,
                        "routing_http_response_access_control_allow_origin_header_value": true,
                        "routing_http_response_access_control_expose_headers_header_value": true,
                        "routing_http_response_access_control_max_age_header_value": true,
                        "routing_http_response_content_security_policy_header_value": true,
                        "routing_http_response_server_enabled": true,
                        "routing_http_response_strict_transport_security_header_value": true,
                        "routing_http_response_x_content_type_options_header_value": true,
                        "routing_http_response_x_frame_options_header_value": true,
                        "ssl_policy": true,
                        "tags_all": {},
                        "tcp_idle_timeout_seconds": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "default_action": [
                            {
                                "authenticate_cognito": [],
                                "authenticate_oidc": [],
                                "fixed_response": [],
                                "forward": [],
                                "order": true,
                                "redirect": [],
                                "target_group_arn": true
                            }
                        ],
                        "id": true,
                        "load_balancer_arn": true,
                        "mutual_authentication": true,
                        "routing_http_request_x_amzn_mtls_clientcert_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_issuer_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_leaf_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_subject_header_name": true,
                        "routing_http_request_x_amzn_mtls_clientcert_validity_header_name": true,
                        "routing_http_request_x_amzn_tls_cipher_suite_header_name": true,
                        "routing_http_request_x_amzn_tls_version_header_name": true,
                        "routing_http_response_access_control_allow_credentials_header_value": true,
                        "routing_http_response_access_control_allow_headers_header_value": true,
                        "routing_http_response_access_control_allow_methods_header_value": true,
                        "routing_http_response_access_control_allow_origin_header_value": true,
                        "routing_http_response_access_control_expose_headers_header_value": true,
                        "routing_http_response_access_control_max_age_header_value": true,
                        "routing_http_response_content_security_policy_header_value": true,
                        "routing_http_response_server_enabled": true,
                        "routing_http_response_strict_transport_security_header_value": true,
                        "routing_http_response_x_content_type_options_header_value": true,
                        "routing_http_response_x_frame_options_header_value": true,
                        "ssl_policy": true,
                        "tags_all": true,
                        "tcp_idle_timeout_seconds": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "default_action": [
                            {
                                "authenticate_cognito": [],
                                "authenticate_oidc": [],
                                "fixed_response": [],
                                "forward": [],
                                "redirect": []
                            }
                        ],
                        "mutual_authentication": [],
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_lb_target_group.main",
                "mode": "managed",
                "type": "aws_lb_target_group",
                "name": "main",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "deregistration_delay": "300",
                        "health_check": [
                            {}
                        ],
                        "lambda_multi_value_headers_enabled": false,
                        "name": "waf-alb-targets",
                        "port": 80,
                        "protocol": "HTTP",
                        "proxy_protocol_v2": false,
                        "slow_start": 0,
                        "tags": {},
                        "tags_all": {},
                        "target_type": "instance",
                        "arn": true,
                        "arn_suffix": true,
                        "connection_termination": true,
                        "id": true,
                        "ip_address_type": true,
                        "load_balancer_arns": [],
                        "load_balancing_algorithm_type": true,
                        "load_balancing_anomaly_mitigation": true,
                        "load_balancing_cross_zone_enabled": true,
                        "name_prefix": true,
                        "preserve_client_ip": true,
                        "protocol_version": true,
                        "stickiness": [],
                        "target_failover": [],
                        "target_group_health": [],
                        "target_health_state": [],
                        "vpc_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "arn_suffix": true,
                        "connection_termination": true,
                        "health_check": [
                            {}
                        ],
                        "id": true,
                        "ip_address_type": true,
                        "load_balancer_arns": true,
                        "load_balancing_algorithm_type": true,
                        "load_balancing_anomaly_mitigation": true,
                        "load_balancing_cross_zone_enabled": true,
                        "name_prefix": true,
                        "preserve_client_ip": true,
                        "protocol_version": true,
                        "stickiness": true,
                        "tags": {},
                        "tags_all": {},
                        "target_failover": true,
                        "target_group_health": true,
                        "target_health_state": true,
                        "vpc_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "health_check": [
                            {}
                        ],
                        "load_balancer_arns": [],
                        "stickiness": [],
                        "tags": {},
                        "tags_all": {},
                        "target_failover": [],
                        "target_group_health": [],
                        "target_health_state": []
                    }
                }
            },
            {
                "address": "aws_route_table.public",
                "mode": "managed",
                "type": "aws_route_table",
                "name": "public",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "route": [
                            {}
                        ],
                        "tags": {},
                        "tags_all": {},
                        "timeouts": null,
                        "arn": true,
                        "id": true,
                        "owner_id": true,
                        "propagating_vgws": [],
                        "vpc_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "id": true,
                        "owner_id": true,
                        "propagating_vgws": true,
                        "route": [
                            {
                                "gateway_id": true
                            }
                        ],
                        "tags": {},
                        "tags_all": {},
                        "vpc_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "propagating_vgws": [],
                        "route": [
                            {}
                        ],
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_route_table_association.public_a",
                "mode": "managed",
                "type": "aws_route_table_association",
                "name": "public_a",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "gateway_id": null,
                        "timeouts": null,
                        "id": true,
                        "route_table_id": true,
                        "subnet_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "id": true,
                        "route_table_id": true,
                        "subnet_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {}
                }
            },
            {
                "address": "aws_route_table_association.public_b",
                "mode": "managed",
                "type": "aws_route_table_association",
                "name": "public_b",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "gateway_id": null,
                        "timeouts": null,
                        "id": true,
                        "route_table_id": true,
                        "subnet_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "id": true,
                        "route_table_id": true,
                        "subnet_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {}
                }
            },
            {
                "address": "aws_security_group.alb",
                "mode": "managed",
                "type": "aws_security_group",
                "name": "alb",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "description": "Security group for ALB with WAF",
                        "egress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "ingress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            },
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "name": "waf-alb-sg",
                        "revoke_rules_on_delete": false,
                        "tags": {},
                        "tags_all": {},
                        "timeouts": null,
                        "arn": true,
                        "id": true,
                        "name_prefix": true,
                        "owner_id": true,
                        "vpc_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "egress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "id": true,
                        "ingress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            },
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "name_prefix": true,
                        "owner_id": true,
                        "tags": {},
                        "tags_all": {},
                        "vpc_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "egress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "ingress": [
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            },
                            {
                                "cidr_blocks": [
                                    false
                                ],
                                "ipv6_cidr_blocks": [],
                                "prefix_list_ids": [],
                                "security_groups": []
                            }
                        ],
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_subnet.public_a",
                "mode": "managed",
                "type": "aws_subnet",
                "name": "public_a",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "assign_ipv6_address_on_creation": false,
                        "availability_zone": "us-west-2a",
                        "cidr_block": "10.0.1.0/24",
                        "customer_owned_ipv4_pool": null,
                        "enable_dns64": false,
                        "enable_lni_at_device_index": null,
                        "enable_resource_name_dns_a_record_on_launch": false,
                        "enable_resource_name_dns_aaaa_record_on_launch": false,
                        "ipv6_cidr_block": null,
                        "ipv6_native": false,
                        "map_customer_owned_ip_on_launch": null,
                        "map_public_ip_on_launch": true,
                        "outpost_arn": null,
                        "tags": {},
                        "tags_all": {},
                        "timeouts": null,
                        "arn": true,
                        "availability_zone_id": true,
                        "id": true,
                        "ipv6_cidr_block_association_id": true,
                        "owner_id": true,
                        "private_dns_hostname_type_on_launch": true,
                        "vpc_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "availability_zone_id": true,
                        "id": true,
                        "ipv6_cidr_block_association_id": true,
                        "owner_id": true,
                        "private_dns_hostname_type_on_launch": true,
                        "tags": {},
                        "tags_all": {},
                        "vpc_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_subnet.public_b",
                "mode": "managed",
                "type": "aws_subnet",
                "name": "public_b",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "assign_ipv6_address_on_creation": false,
                        "availability_zone": "us-west-2b",
                        "cidr_block": "10.0.2.0/24",
                        "customer_owned_ipv4_pool": null,
                        "enable_dns64": false,
                        "enable_lni_at_device_index": null,
                        "enable_resource_name_dns_a_record_on_launch": false,
                        "enable_resource_name_dns_aaaa_record_on_launch": false,
                        "ipv6_cidr_block": null,
                        "ipv6_native": false,
                        "map_customer_owned_ip_on_launch": null,
                        "map_public_ip_on_launch": true,
                        "outpost_arn": null,
                        "tags": {},
                        "tags_all": {},
                        "timeouts": null,
                        "arn": true,
                        "availability_zone_id": true,
                        "id": true,
                        "ipv6_cidr_block_association_id": true,
                        "owner_id": true,
                        "private_dns_hostname_type_on_launch": true,
                        "vpc_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "availability_zone_id": true,
                        "id": true,
                        "ipv6_cidr_block_association_id": true,
                        "owner_id": true,
                        "private_dns_hostname_type_on_launch": true,
                        "tags": {},
                        "tags_all": {},
                        "vpc_id": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_vpc.main",
                "mode": "managed",
                "type": "aws_vpc",
                "name": "main",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "assign_generated_ipv6_cidr_block": null,
                        "cidr_block": "10.0.0.0/16",
                        "enable_dns_hostnames": true,
                        "enable_dns_support": true,
                        "instance_tenancy": "default",
                        "ipv4_ipam_pool_id": null,
                        "ipv4_netmask_length": null,
                        "ipv6_ipam_pool_id": null,
                        "ipv6_netmask_length": null,
                        "tags": {},
                        "tags_all": {},
                        "arn": true,
                        "default_network_acl_id": true,
                        "default_route_table_id": true,
                        "default_security_group_id": true,
                        "dhcp_options_id": true,
                        "enable_network_address_usage_metrics": true,
                        "id": true,
                        "ipv6_association_id": true,
                        "ipv6_cidr_block": true,
                        "ipv6_cidr_block_network_border_group": true,
                        "main_route_table_id": true,
                        "owner_id": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "arn": true,
                        "default_network_acl_id": true,
                        "default_route_table_id": true,
                        "default_security_group_id": true,
                        "dhcp_options_id": true,
                        "enable_network_address_usage_metrics": true,
                        "id": true,
                        "ipv6_association_id": true,
                        "ipv6_cidr_block": true,
                        "ipv6_cidr_block_network_border_group": true,
                        "main_route_table_id": true,
                        "owner_id": true,
                        "tags": {},
                        "tags_all": {}
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "tags": {},
                        "tags_all": {}
                    }
                }
            },
            {
                "address": "aws_wafv2_web_acl.alb",
                "mode": "managed",
                "type": "aws_wafv2_web_acl",
                "name": "alb",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "association_config": [],
                        "captcha_config": [],
                        "challenge_config": [],
                        "custom_response_body": [],
                        "data_protection_config": [],
                        "default_action": [
                            {
                                "allow": [
                                    {
                                        "custom_request_handling": []
                                    }
                                ],
                                "block": []
                            }
                        ],
                        "description": null,
                        "name": "alb-web-acl",
                        "rule": [
                            {
                                "action": [
                                    {
                                        "allow": [],
                                        "block": [
                                            {
                                                "custom_response": []
                                            }
                                        ],
                                        "captcha": [],
                                        "challenge": [],
                                        "count": []
                                    }
                                ],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [
                                            {
                                                "custom_key": [],
                                                "forwarded_ip_config": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            },
                            {
                                "action": [],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [
                                    {
                                        "count": [],
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [
                                            {
                                                "managed_rule_group_configs": [],
                                                "rule_action_override": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            },
                            {
                                "action": [],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [
                                    {
                                        "count": [],
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [
                                            {
                                                "managed_rule_group_configs": [],
                                                "rule_action_override": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            }
                        ],
                        "rule_json": null,
                        "scope": "REGIONAL",
                        "tags": {},
                        "tags_all": {},
                        "token_domains": null,
                        "visibility_config": [
                            {}
                        ],
                        "application_integration_url": true,
                        "arn": true,
                        "capacity": true,
                        "id": true,
                        "lock_token": true,
                        "name_prefix": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "application_integration_url": true,
                        "arn": true,
                        "association_config": [],
                        "capacity": true,
                        "captcha_config": [],
                        "challenge_config": [],
                        "custom_response_body": [],
                        "data_protection_config": [],
                        "default_action": [
                            {
                                "allow": [
                                    {
                                        "custom_request_handling": []
                                    }
                                ],
                                "block": []
                            }
                        ],
                        "id": true,
                        "lock_token": true,
                        "name_prefix": true,
                        "rule": [
                            {
                                "action": [
                                    {
                                        "allow": [],
                                        "block": [
                                            {
                                                "custom_response": []
                                            }
                                        ],
                                        "captcha": [],
                                        "challenge": [],
                                        "count": []
                                    }
                                ],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [
                                            {
                                                "custom_key": [],
                                                "forwarded_ip_config": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            },
                            {
                                "action": [],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [
                                    {
                                        "count": [],
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [
                                            {
                                                "managed_rule_group_configs": [],
                                                "rule_action_override": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            },
                            {
                                "action": [],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [
                                    {
                                        "count": [],
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [
                                            {
                                                "managed_rule_group_configs": [],
                                                "rule_action_override": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            }
                        ],
                        "tags": {},
                        "tags_all": {},
                        "visibility_config": [
                            {}
                        ]
                    },
                    "before_sensitive": false,
                    "after_sensitive": {
                        "association_config": [],
                        "captcha_config": [],
                        "challenge_config": [],
                        "custom_response_body": [],
                        "data_protection_config": [],
                        "default_action": [
                            {
                                "allow": [
                                    {
                                        "custom_request_handling": []
                                    }
                                ],
                                "block": []
                            }
                        ],
                        "rule": [
                            {
                                "action": [
                                    {
                                        "allow": [],
                                        "block": [
                                            {
                                                "custom_response": []
                                            }
                                        ],
                                        "captcha": [],
                                        "challenge": [],
                                        "count": []
                                    }
                                ],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [
                                            {
                                                "custom_key": [],
                                                "forwarded_ip_config": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            },
                            {
                                "action": [],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [
                                    {
                                        "count": [],
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [
                                            {
                                                "managed_rule_group_configs": [],
                                                "rule_action_override": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            },
                            {
                                "action": [],
                                "captcha_config": [],
                                "challenge_config": [],
                                "override_action": [
                                    {
                                        "count": [],
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "rule_label": [],
                                "statement": [
                                    {
                                        "and_statement": [],
                                        "asn_match_statement": [],
                                        "byte_match_statement": [],
                                        "geo_match_statement": [],
                                        "ip_set_reference_statement": [],
                                        "label_match_statement": [],
                                        "managed_rule_group_statement": [
                                            {
                                                "managed_rule_group_configs": [],
                                                "rule_action_override": [],
                                                "scope_down_statement": []
                                            }
                                        ],
                                        "not_statement": [],
                                        "or_statement": [],
                                        "rate_based_statement": [],
                                        "regex_match_statement": [],
                                        "regex_pattern_set_reference_statement": [],
                                        "rule_group_reference_statement": [],
                                        "size_constraint_statement": [],
                                        "sqli_match_statement": [],
                                        "xss_match_statement": []
                                    }
                                ],
                                "visibility_config": [
                                    {}
                                ]
                            }
                        ],
                        "tags": {},
                        "tags_all": {},
                        "visibility_config": [
                            {}
                        ]
                    }
                }
            },
            {
                "address": "aws_wafv2_web_acl_association.alb",
                "mode": "managed",
                "type": "aws_wafv2_web_acl_association",
                "name": "alb",
                "provider_name": "registry.terraform.io/hashicorp/aws",
                "change": {
                    "actions": [
                        "create"
                    ],
                    "before": null,
                    "after": {
                        "timeouts": null,
                        "id": true,
                        "resource_arn": true,
                        "web_acl_arn": true,
                        "module": "main"
                    },
                    "after_unknown": {
                        "id": true,
                        "resource_arn": true,
                        "web_acl_arn": true
                    },
                    "before_sensitive": false,
                    "after_sensitive": {}
                }
            }
        ],
        "output_changes": {
            "alb_dns": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after_unknown": true,
                "before_sensitive": false,
                "after_sensitive": false
            },
            "waf_arn": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after_unknown": true,
                "before_sensitive": false,
                "after_sensitive": false
            },
            "waf_association": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after_unknown": true,
                "before_sensitive": false,
                "after_sensitive": false
            }
        },
        "configuration": {
            "provider_config": {
                "aws": {
                    "name": "aws",
                    "full_name": "registry.terraform.io/hashicorp/aws",
                    "version_constraint": "~> 5.0",
                    "expressions": {
                        "region": {
                            "constant_value": "us-west-2"
                        }
                    }
                }
            },
            "root_module": {
                "outputs": {
                    "alb_dns": {
                        "expression": {
                            "references": [
                                "aws_lb.main.dns_name",
                                "aws_lb.main"
                            ]
                        },
                        "description": "ALB DNS name"
                    },
                    "waf_arn": {
                        "expression": {
                            "references": [
                                "aws_wafv2_web_acl.alb.arn",
                                "aws_wafv2_web_acl.alb"
                            ]
                        },
                        "description": "WAF WebACL ARN"
                    },
                    "waf_association": {
                        "expression": {
                            "references": [
                                "aws_wafv2_web_acl_association.alb.id",
                                "aws_wafv2_web_acl_association.alb"
                            ]
                        },
                        "description": "WAF association ID"
                    }
                },
                "resources": [
                    {
                        "address": "aws_internet_gateway.main",
                        "mode": "managed",
                        "type": "aws_internet_gateway",
                        "name": "main",
                        "provider_config_key": "aws",
                        "expressions": {
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-igw"
                                }
                            },
                            "vpc_id": {
                                "references": [
                                    "aws_vpc.main.id",
                                    "aws_vpc.main"
                                ]
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_lb.main",
                        "mode": "managed",
                        "type": "aws_lb",
                        "name": "main",
                        "provider_config_key": "aws",
                        "expressions": {
                            "enable_deletion_protection": {
                                "constant_value": false
                            },
                            "internal": {
                                "constant_value": false
                            },
                            "load_balancer_type": {
                                "constant_value": "application"
                            },
                            "name": {
                                "constant_value": "waf-protected-alb"
                            },
                            "security_groups": {
                                "references": [
                                    "aws_security_group.alb.id",
                                    "aws_security_group.alb"
                                ]
                            },
                            "subnets": {
                                "references": [
                                    "aws_subnet.public_a.id",
                                    "aws_subnet.public_a",
                                    "aws_subnet.public_b.id",
                                    "aws_subnet.public_b"
                                ]
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-protected-alb"
                                }
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_lb_listener.http",
                        "mode": "managed",
                        "type": "aws_lb_listener",
                        "name": "http",
                        "provider_config_key": "aws",
                        "expressions": {
                            "default_action": [
                                {
                                    "target_group_arn": {
                                        "references": [
                                            "aws_lb_target_group.main.arn",
                                            "aws_lb_target_group.main"
                                        ]
                                    },
                                    "type": {
                                        "constant_value": "forward"
                                    }
                                }
                            ],
                            "load_balancer_arn": {
                                "references": [
                                    "aws_lb.main.arn",
                                    "aws_lb.main"
                                ]
                            },
                            "port": {
                                "constant_value": "80"
                            },
                            "protocol": {
                                "constant_value": "HTTP"
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_lb_target_group.main",
                        "mode": "managed",
                        "type": "aws_lb_target_group",
                        "name": "main",
                        "provider_config_key": "aws",
                        "expressions": {
                            "health_check": [
                                {
                                    "enabled": {
                                        "constant_value": true
                                    },
                                    "healthy_threshold": {
                                        "constant_value": 2
                                    },
                                    "interval": {
                                        "constant_value": 30
                                    },
                                    "matcher": {
                                        "constant_value": "200"
                                    },
                                    "path": {
                                        "constant_value": "/"
                                    },
                                    "port": {
                                        "constant_value": "traffic-port"
                                    },
                                    "protocol": {
                                        "constant_value": "HTTP"
                                    },
                                    "timeout": {
                                        "constant_value": 5
                                    },
                                    "unhealthy_threshold": {
                                        "constant_value": 2
                                    }
                                }
                            ],
                            "name": {
                                "constant_value": "waf-alb-targets"
                            },
                            "port": {
                                "constant_value": 80
                            },
                            "protocol": {
                                "constant_value": "HTTP"
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-targets"
                                }
                            },
                            "vpc_id": {
                                "references": [
                                    "aws_vpc.main.id",
                                    "aws_vpc.main"
                                ]
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_route_table.public",
                        "mode": "managed",
                        "type": "aws_route_table",
                        "name": "public",
                        "provider_config_key": "aws",
                        "expressions": {
                            "route": {
                                "references": [
                                    "aws_internet_gateway.main.id",
                                    "aws_internet_gateway.main"
                                ]
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-public-rt"
                                }
                            },
                            "vpc_id": {
                                "references": [
                                    "aws_vpc.main.id",
                                    "aws_vpc.main"
                                ]
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_route_table_association.public_a",
                        "mode": "managed",
                        "type": "aws_route_table_association",
                        "name": "public_a",
                        "provider_config_key": "aws",
                        "expressions": {
                            "route_table_id": {
                                "references": [
                                    "aws_route_table.public.id",
                                    "aws_route_table.public"
                                ]
                            },
                            "subnet_id": {
                                "references": [
                                    "aws_subnet.public_a.id",
                                    "aws_subnet.public_a"
                                ]
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_route_table_association.public_b",
                        "mode": "managed",
                        "type": "aws_route_table_association",
                        "name": "public_b",
                        "provider_config_key": "aws",
                        "expressions": {
                            "route_table_id": {
                                "references": [
                                    "aws_route_table.public.id",
                                    "aws_route_table.public"
                                ]
                            },
                            "subnet_id": {
                                "references": [
                                    "aws_subnet.public_b.id",
                                    "aws_subnet.public_b"
                                ]
                            }
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_security_group.alb",
                        "mode": "managed",
                        "type": "aws_security_group",
                        "name": "alb",
                        "provider_config_key": "aws",
                        "expressions": {
                            "description": {
                                "constant_value": "Security group for ALB with WAF"
                            },
                            "egress": {
                                "constant_value": [
                                    {
                                        "cidr_blocks": [
                                            "0.0.0.0/0"
                                        ],
                                        "description": "All outbound traffic",
                                        "from_port": 0,
                                        "ipv6_cidr_blocks": null,
                                        "prefix_list_ids": null,
                                        "protocol": "-1",
                                        "security_groups": null,
                                        "self": null,
                                        "to_port": 0
                                    }
                                ]
                            },
                            "ingress": {
                                "constant_value": [
                                    {
                                        "cidr_blocks": [
                                            "0.0.0.0/0"
                                        ],
                                        "description": "HTTPS from anywhere",
                                        "from_port": 443,
                                        "ipv6_cidr_blocks": null,
                                        "prefix_list_ids": null,
                                        "protocol": "tcp",
                                        "security_groups": null,
                                        "self": null,
                                        "to_port": 443
                                    },
                                    {
                                        "cidr_blocks": [
                                            "0.0.0.0/0"
                                        ],
                                        "description": "HTTP from anywhere",
                                        "from_port": 80,
                                        "ipv6_cidr_blocks": null,
                                        "prefix_list_ids": null,
                                        "protocol": "tcp",
                                        "security_groups": null,
                                        "self": null,
                                        "to_port": 80
                                    }
                                ]
                            },
                            "name": {
                                "constant_value": "waf-alb-sg"
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-sg"
                                }
                            },
                            "vpc_id": {
                                "references": [
                                    "aws_vpc.main.id",
                                    "aws_vpc.main"
                                ]
                            }
                        },
                        "schema_version": 1
                    },
                    {
                        "address": "aws_subnet.public_a",
                        "mode": "managed",
                        "type": "aws_subnet",
                        "name": "public_a",
                        "provider_config_key": "aws",
                        "expressions": {
                            "availability_zone": {
                                "constant_value": "us-west-2a"
                            },
                            "cidr_block": {
                                "constant_value": "10.0.1.0/24"
                            },
                            "map_public_ip_on_launch": {
                                "constant_value": true
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-public-a"
                                }
                            },
                            "vpc_id": {
                                "references": [
                                    "aws_vpc.main.id",
                                    "aws_vpc.main"
                                ]
                            }
                        },
                        "schema_version": 1
                    },
                    {
                        "address": "aws_subnet.public_b",
                        "mode": "managed",
                        "type": "aws_subnet",
                        "name": "public_b",
                        "provider_config_key": "aws",
                        "expressions": {
                            "availability_zone": {
                                "constant_value": "us-west-2b"
                            },
                            "cidr_block": {
                                "constant_value": "10.0.2.0/24"
                            },
                            "map_public_ip_on_launch": {
                                "constant_value": true
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-public-b"
                                }
                            },
                            "vpc_id": {
                                "references": [
                                    "aws_vpc.main.id",
                                    "aws_vpc.main"
                                ]
                            }
                        },
                        "schema_version": 1
                    },
                    {
                        "address": "aws_vpc.main",
                        "mode": "managed",
                        "type": "aws_vpc",
                        "name": "main",
                        "provider_config_key": "aws",
                        "expressions": {
                            "cidr_block": {
                                "constant_value": "10.0.0.0/16"
                            },
                            "enable_dns_hostnames": {
                                "constant_value": true
                            },
                            "enable_dns_support": {
                                "constant_value": true
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "waf-alb-test-vpc"
                                }
                            }
                        },
                        "schema_version": 1
                    },
                    {
                        "address": "aws_wafv2_web_acl.alb",
                        "mode": "managed",
                        "type": "aws_wafv2_web_acl",
                        "name": "alb",
                        "provider_config_key": "aws",
                        "expressions": {
                            "default_action": [
                                {
                                    "allow": [
                                        {}
                                    ]
                                }
                            ],
                            "name": {
                                "constant_value": "alb-web-acl"
                            },
                            "rule": [
                                {
                                    "name": {
                                        "constant_value": "sql-injection-rule"
                                    },
                                    "override_action": [
                                        {
                                            "none": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "priority": {
                                        "constant_value": 1
                                    },
                                    "statement": [
                                        {
                                            "managed_rule_group_statement": [
                                                {
                                                    "name": {
                                                        "constant_value": "AWSManagedRulesSQLiRuleSet"
                                                    },
                                                    "vendor_name": {
                                                        "constant_value": "AWS"
                                                    }
                                                }
                                            ]
                                        }
                                    ],
                                    "visibility_config": [
                                        {
                                            "cloudwatch_metrics_enabled": {
                                                "constant_value": true
                                            },
                                            "metric_name": {
                                                "constant_value": "SQLInjectionRule"
                                            },
                                            "sampled_requests_enabled": {
                                                "constant_value": true
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": {
                                        "constant_value": "xss-protection-rule"
                                    },
                                    "override_action": [
                                        {
                                            "none": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "priority": {
                                        "constant_value": 2
                                    },
                                    "statement": [
                                        {
                                            "managed_rule_group_statement": [
                                                {
                                                    "name": {
                                                        "constant_value": "AWSManagedRulesKnownBadInputsRuleSet"
                                                    },
                                                    "vendor_name": {
                                                        "constant_value": "AWS"
                                                    }
                                                }
                                            ]
                                        }
                                    ],
                                    "visibility_config": [
                                        {
                                            "cloudwatch_metrics_enabled": {
                                                "constant_value": true
                                            },
                                            "metric_name": {
                                                "constant_value": "XSSProtectionRule"
                                            },
                                            "sampled_requests_enabled": {
                                                "constant_value": true
                                            }
                                        }
                                    ]
                                },
                                {
                                    "action": [
                                        {
                                            "block": [
                                                {}
                                            ]
                                        }
                                    ],
                                    "name": {
                                        "constant_value": "rate-limit-rule"
                                    },
                                    "priority": {
                                        "constant_value": 3
                                    },
                                    "statement": [
                                        {
                                            "rate_based_statement": [
                                                {
                                                    "aggregate_key_type": {
                                                        "constant_value": "IP"
                                                    },
                                                    "limit": {
                                                        "constant_value": 1000
                                                    }
                                                }
                                            ]
                                        }
                                    ],
                                    "visibility_config": [
                                        {
                                            "cloudwatch_metrics_enabled": {
                                                "constant_value": true
                                            },
                                            "metric_name": {
                                                "constant_value": "RateLimitRule"
                                            },
                                            "sampled_requests_enabled": {
                                                "constant_value": true
                                            }
                                        }
                                    ]
                                }
                            ],
                            "scope": {
                                "constant_value": "REGIONAL"
                            },
                            "tags": {
                                "constant_value": {
                                    "Name": "alb-web-acl"
                                }
                            },
                            "visibility_config": [
                                {
                                    "cloudwatch_metrics_enabled": {
                                        "constant_value": true
                                    },
                                    "metric_name": {
                                        "constant_value": "ALBWebACL"
                                    },
                                    "sampled_requests_enabled": {
                                        "constant_value": true
                                    }
                                }
                            ]
                        },
                        "schema_version": 0
                    },
                    {
                        "address": "aws_wafv2_web_acl_association.alb",
                        "mode": "managed",
                        "type": "aws_wafv2_web_acl_association",
                        "name": "alb",
                        "provider_config_key": "aws",
                        "expressions": {
                            "resource_arn": {
                                "references": [
                                    "aws_lb.main.arn",
                                    "aws_lb.main"
                                ]
                            },
                            "web_acl_arn": {
                                "references": [
                                    "aws_wafv2_web_acl.alb.arn",
                                    "aws_wafv2_web_acl.alb"
                                ]
                            }
                        },
                        "schema_version": 0
                    }
                ]
            }
        },
        "relevant_attributes": [
            {
                "resource": "aws_lb.main",
                "attribute": [
                    "arn"
                ]
            },
            {
                "resource": "aws_security_group.alb",
                "attribute": [
                    "id"
                ]
            },
            {
                "resource": "aws_subnet.public_b",
                "attribute": [
                    "id"
                ]
            },
            {
                "resource": "aws_lb.main",
                "attribute": [
                    "dns_name"
                ]
            },
            {
                "resource": "aws_wafv2_web_acl.alb",
                "attribute": [
                    "arn"
                ]
            },
            {
                "resource": "aws_route_table.public",
                "attribute": [
                    "id"
                ]
            },
            {
                "resource": "aws_wafv2_web_acl_association.alb",
                "attribute": [
                    "id"
                ]
            },
            {
                "resource": "aws_lb_target_group.main",
                "attribute": [
                    "arn"
                ]
            },
            {
                "resource": "aws_subnet.public_a",
                "attribute": [
                    "id"
                ]
            },
            {
                "resource": "aws_internet_gateway.main",
                "attribute": [
                    "id"
                ]
            },
            {
                "resource": "aws_vpc.main",
                "attribute": [
                    "id"
                ]
            }
        ],
        "timestamp": "2025-12-30T08:29:02Z",
        "applyable": true,
        "complete": true,
        "errored": false
    },
    "tf_resources_created": [
        {
            "address": "aws_internet_gateway.main",
            "mode": "managed",
            "type": "aws_internet_gateway",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "tags": {},
                    "tags_all": {},
                    "timeouts": null,
                    "arn": true,
                    "id": true,
                    "owner_id": true,
                    "vpc_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "id": true,
                    "owner_id": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_lb.main",
            "mode": "managed",
            "type": "aws_lb",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "access_logs": [],
                    "client_keep_alive": 3600,
                    "connection_logs": [],
                    "customer_owned_ipv4_pool": null,
                    "desync_mitigation_mode": "defensive",
                    "dns_record_client_routing_policy": null,
                    "drop_invalid_header_fields": false,
                    "enable_cross_zone_load_balancing": null,
                    "enable_deletion_protection": false,
                    "enable_http2": true,
                    "enable_tls_version_and_cipher_suite_headers": false,
                    "enable_waf_fail_open": false,
                    "enable_xff_client_port": false,
                    "enable_zonal_shift": false,
                    "idle_timeout": 60,
                    "internal": false,
                    "ipam_pools": [],
                    "load_balancer_type": "application",
                    "minimum_load_balancer_capacity": [],
                    "name": "waf-protected-alb",
                    "preserve_host_header": false,
                    "tags": {},
                    "tags_all": {},
                    "timeouts": null,
                    "xff_header_processing_mode": "append",
                    "arn": true,
                    "arn_suffix": true,
                    "dns_name": true,
                    "enforce_security_group_inbound_rules_on_private_link_traffic": true,
                    "id": true,
                    "ip_address_type": true,
                    "name_prefix": true,
                    "security_groups": [],
                    "subnet_mapping": [],
                    "subnets": [],
                    "vpc_id": true,
                    "zone_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "access_logs": [],
                    "arn": true,
                    "arn_suffix": true,
                    "connection_logs": [],
                    "dns_name": true,
                    "enforce_security_group_inbound_rules_on_private_link_traffic": true,
                    "id": true,
                    "ip_address_type": true,
                    "ipam_pools": [],
                    "minimum_load_balancer_capacity": [],
                    "name_prefix": true,
                    "security_groups": true,
                    "subnet_mapping": true,
                    "subnets": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true,
                    "zone_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "access_logs": [],
                    "connection_logs": [],
                    "ipam_pools": [],
                    "minimum_load_balancer_capacity": [],
                    "security_groups": [],
                    "subnet_mapping": [],
                    "subnets": [],
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_lb_listener.http",
            "mode": "managed",
            "type": "aws_lb_listener",
            "name": "http",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "alpn_policy": null,
                    "certificate_arn": null,
                    "default_action": [
                        {
                            "authenticate_cognito": [],
                            "authenticate_oidc": [],
                            "fixed_response": [],
                            "forward": [],
                            "redirect": []
                        }
                    ],
                    "port": 80,
                    "protocol": "HTTP",
                    "tags": null,
                    "timeouts": null,
                    "arn": true,
                    "id": true,
                    "load_balancer_arn": true,
                    "mutual_authentication": [],
                    "routing_http_request_x_amzn_mtls_clientcert_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_issuer_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_leaf_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_subject_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_validity_header_name": true,
                    "routing_http_request_x_amzn_tls_cipher_suite_header_name": true,
                    "routing_http_request_x_amzn_tls_version_header_name": true,
                    "routing_http_response_access_control_allow_credentials_header_value": true,
                    "routing_http_response_access_control_allow_headers_header_value": true,
                    "routing_http_response_access_control_allow_methods_header_value": true,
                    "routing_http_response_access_control_allow_origin_header_value": true,
                    "routing_http_response_access_control_expose_headers_header_value": true,
                    "routing_http_response_access_control_max_age_header_value": true,
                    "routing_http_response_content_security_policy_header_value": true,
                    "routing_http_response_server_enabled": true,
                    "routing_http_response_strict_transport_security_header_value": true,
                    "routing_http_response_x_content_type_options_header_value": true,
                    "routing_http_response_x_frame_options_header_value": true,
                    "ssl_policy": true,
                    "tags_all": {},
                    "tcp_idle_timeout_seconds": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "default_action": [
                        {
                            "authenticate_cognito": [],
                            "authenticate_oidc": [],
                            "fixed_response": [],
                            "forward": [],
                            "order": true,
                            "redirect": [],
                            "target_group_arn": true
                        }
                    ],
                    "id": true,
                    "load_balancer_arn": true,
                    "mutual_authentication": true,
                    "routing_http_request_x_amzn_mtls_clientcert_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_issuer_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_leaf_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_subject_header_name": true,
                    "routing_http_request_x_amzn_mtls_clientcert_validity_header_name": true,
                    "routing_http_request_x_amzn_tls_cipher_suite_header_name": true,
                    "routing_http_request_x_amzn_tls_version_header_name": true,
                    "routing_http_response_access_control_allow_credentials_header_value": true,
                    "routing_http_response_access_control_allow_headers_header_value": true,
                    "routing_http_response_access_control_allow_methods_header_value": true,
                    "routing_http_response_access_control_allow_origin_header_value": true,
                    "routing_http_response_access_control_expose_headers_header_value": true,
                    "routing_http_response_access_control_max_age_header_value": true,
                    "routing_http_response_content_security_policy_header_value": true,
                    "routing_http_response_server_enabled": true,
                    "routing_http_response_strict_transport_security_header_value": true,
                    "routing_http_response_x_content_type_options_header_value": true,
                    "routing_http_response_x_frame_options_header_value": true,
                    "ssl_policy": true,
                    "tags_all": true,
                    "tcp_idle_timeout_seconds": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "default_action": [
                        {
                            "authenticate_cognito": [],
                            "authenticate_oidc": [],
                            "fixed_response": [],
                            "forward": [],
                            "redirect": []
                        }
                    ],
                    "mutual_authentication": [],
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_lb_target_group.main",
            "mode": "managed",
            "type": "aws_lb_target_group",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "deregistration_delay": "300",
                    "health_check": [
                        {}
                    ],
                    "lambda_multi_value_headers_enabled": false,
                    "name": "waf-alb-targets",
                    "port": 80,
                    "protocol": "HTTP",
                    "proxy_protocol_v2": false,
                    "slow_start": 0,
                    "tags": {},
                    "tags_all": {},
                    "target_type": "instance",
                    "arn": true,
                    "arn_suffix": true,
                    "connection_termination": true,
                    "id": true,
                    "ip_address_type": true,
                    "load_balancer_arns": [],
                    "load_balancing_algorithm_type": true,
                    "load_balancing_anomaly_mitigation": true,
                    "load_balancing_cross_zone_enabled": true,
                    "name_prefix": true,
                    "preserve_client_ip": true,
                    "protocol_version": true,
                    "stickiness": [],
                    "target_failover": [],
                    "target_group_health": [],
                    "target_health_state": [],
                    "vpc_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "arn_suffix": true,
                    "connection_termination": true,
                    "health_check": [
                        {}
                    ],
                    "id": true,
                    "ip_address_type": true,
                    "load_balancer_arns": true,
                    "load_balancing_algorithm_type": true,
                    "load_balancing_anomaly_mitigation": true,
                    "load_balancing_cross_zone_enabled": true,
                    "name_prefix": true,
                    "preserve_client_ip": true,
                    "protocol_version": true,
                    "stickiness": true,
                    "tags": {},
                    "tags_all": {},
                    "target_failover": true,
                    "target_group_health": true,
                    "target_health_state": true,
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "health_check": [
                        {}
                    ],
                    "load_balancer_arns": [],
                    "stickiness": [],
                    "tags": {},
                    "tags_all": {},
                    "target_failover": [],
                    "target_group_health": [],
                    "target_health_state": []
                }
            }
        },
        {
            "address": "aws_route_table.public",
            "mode": "managed",
            "type": "aws_route_table",
            "name": "public",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "route": [
                        {}
                    ],
                    "tags": {},
                    "tags_all": {},
                    "timeouts": null,
                    "arn": true,
                    "id": true,
                    "owner_id": true,
                    "propagating_vgws": [],
                    "vpc_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "id": true,
                    "owner_id": true,
                    "propagating_vgws": true,
                    "route": [
                        {
                            "gateway_id": true
                        }
                    ],
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "propagating_vgws": [],
                    "route": [
                        {}
                    ],
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_route_table_association.public_a",
            "mode": "managed",
            "type": "aws_route_table_association",
            "name": "public_a",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "gateway_id": null,
                    "timeouts": null,
                    "id": true,
                    "route_table_id": true,
                    "subnet_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "id": true,
                    "route_table_id": true,
                    "subnet_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        },
        {
            "address": "aws_route_table_association.public_b",
            "mode": "managed",
            "type": "aws_route_table_association",
            "name": "public_b",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "gateway_id": null,
                    "timeouts": null,
                    "id": true,
                    "route_table_id": true,
                    "subnet_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "id": true,
                    "route_table_id": true,
                    "subnet_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        },
        {
            "address": "aws_security_group.alb",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "alb",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "description": "Security group for ALB with WAF",
                    "egress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "ingress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        },
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "name": "waf-alb-sg",
                    "revoke_rules_on_delete": false,
                    "tags": {},
                    "tags_all": {},
                    "timeouts": null,
                    "arn": true,
                    "id": true,
                    "name_prefix": true,
                    "owner_id": true,
                    "vpc_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "egress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "id": true,
                    "ingress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        },
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "name_prefix": true,
                    "owner_id": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "egress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "ingress": [
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        },
                        {
                            "cidr_blocks": [
                                false
                            ],
                            "ipv6_cidr_blocks": [],
                            "prefix_list_ids": [],
                            "security_groups": []
                        }
                    ],
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_subnet.public_a",
            "mode": "managed",
            "type": "aws_subnet",
            "name": "public_a",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_ipv6_address_on_creation": false,
                    "availability_zone": "us-west-2a",
                    "cidr_block": "10.0.1.0/24",
                    "customer_owned_ipv4_pool": null,
                    "enable_dns64": false,
                    "enable_lni_at_device_index": null,
                    "enable_resource_name_dns_a_record_on_launch": false,
                    "enable_resource_name_dns_aaaa_record_on_launch": false,
                    "ipv6_cidr_block": null,
                    "ipv6_native": false,
                    "map_customer_owned_ip_on_launch": null,
                    "map_public_ip_on_launch": true,
                    "outpost_arn": null,
                    "tags": {},
                    "tags_all": {},
                    "timeouts": null,
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "vpc_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_subnet.public_b",
            "mode": "managed",
            "type": "aws_subnet",
            "name": "public_b",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_ipv6_address_on_creation": false,
                    "availability_zone": "us-west-2b",
                    "cidr_block": "10.0.2.0/24",
                    "customer_owned_ipv4_pool": null,
                    "enable_dns64": false,
                    "enable_lni_at_device_index": null,
                    "enable_resource_name_dns_a_record_on_launch": false,
                    "enable_resource_name_dns_aaaa_record_on_launch": false,
                    "ipv6_cidr_block": null,
                    "ipv6_native": false,
                    "map_customer_owned_ip_on_launch": null,
                    "map_public_ip_on_launch": true,
                    "outpost_arn": null,
                    "tags": {},
                    "tags_all": {},
                    "timeouts": null,
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "vpc_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "availability_zone_id": true,
                    "id": true,
                    "ipv6_cidr_block_association_id": true,
                    "owner_id": true,
                    "private_dns_hostname_type_on_launch": true,
                    "tags": {},
                    "tags_all": {},
                    "vpc_id": true
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_vpc.main",
            "mode": "managed",
            "type": "aws_vpc",
            "name": "main",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "assign_generated_ipv6_cidr_block": null,
                    "cidr_block": "10.0.0.0/16",
                    "enable_dns_hostnames": true,
                    "enable_dns_support": true,
                    "instance_tenancy": "default",
                    "ipv4_ipam_pool_id": null,
                    "ipv4_netmask_length": null,
                    "ipv6_ipam_pool_id": null,
                    "ipv6_netmask_length": null,
                    "tags": {},
                    "tags_all": {},
                    "arn": true,
                    "default_network_acl_id": true,
                    "default_route_table_id": true,
                    "default_security_group_id": true,
                    "dhcp_options_id": true,
                    "enable_network_address_usage_metrics": true,
                    "id": true,
                    "ipv6_association_id": true,
                    "ipv6_cidr_block": true,
                    "ipv6_cidr_block_network_border_group": true,
                    "main_route_table_id": true,
                    "owner_id": true,
                    "module": "main"
                },
                "after_unknown": {
                    "arn": true,
                    "default_network_acl_id": true,
                    "default_route_table_id": true,
                    "default_security_group_id": true,
                    "dhcp_options_id": true,
                    "enable_network_address_usage_metrics": true,
                    "id": true,
                    "ipv6_association_id": true,
                    "ipv6_cidr_block": true,
                    "ipv6_cidr_block_network_border_group": true,
                    "main_route_table_id": true,
                    "owner_id": true,
                    "tags": {},
                    "tags_all": {}
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "tags": {},
                    "tags_all": {}
                }
            }
        },
        {
            "address": "aws_wafv2_web_acl.alb",
            "mode": "managed",
            "type": "aws_wafv2_web_acl",
            "name": "alb",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "association_config": [],
                    "captcha_config": [],
                    "challenge_config": [],
                    "custom_response_body": [],
                    "data_protection_config": [],
                    "default_action": [
                        {
                            "allow": [
                                {
                                    "custom_request_handling": []
                                }
                            ],
                            "block": []
                        }
                    ],
                    "description": null,
                    "name": "alb-web-acl",
                    "rule": [
                        {
                            "action": [
                                {
                                    "allow": [],
                                    "block": [
                                        {
                                            "custom_response": []
                                        }
                                    ],
                                    "captcha": [],
                                    "challenge": [],
                                    "count": []
                                }
                            ],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [
                                        {
                                            "custom_key": [],
                                            "forwarded_ip_config": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        },
                        {
                            "action": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [
                                {
                                    "count": [],
                                    "none": [
                                        {}
                                    ]
                                }
                            ],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [
                                        {
                                            "managed_rule_group_configs": [],
                                            "rule_action_override": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        },
                        {
                            "action": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [
                                {
                                    "count": [],
                                    "none": [
                                        {}
                                    ]
                                }
                            ],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [
                                        {
                                            "managed_rule_group_configs": [],
                                            "rule_action_override": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        }
                    ],
                    "rule_json": null,
                    "scope": "REGIONAL",
                    "tags": {},
                    "tags_all": {},
                    "token_domains": null,
                    "visibility_config": [
                        {}
                    ],
                    "application_integration_url": true,
                    "arn": true,
                    "capacity": true,
                    "id": true,
                    "lock_token": true,
                    "name_prefix": true,
                    "module": "main"
                },
                "after_unknown": {
                    "application_integration_url": true,
                    "arn": true,
                    "association_config": [],
                    "capacity": true,
                    "captcha_config": [],
                    "challenge_config": [],
                    "custom_response_body": [],
                    "data_protection_config": [],
                    "default_action": [
                        {
                            "allow": [
                                {
                                    "custom_request_handling": []
                                }
                            ],
                            "block": []
                        }
                    ],
                    "id": true,
                    "lock_token": true,
                    "name_prefix": true,
                    "rule": [
                        {
                            "action": [
                                {
                                    "allow": [],
                                    "block": [
                                        {
                                            "custom_response": []
                                        }
                                    ],
                                    "captcha": [],
                                    "challenge": [],
                                    "count": []
                                }
                            ],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [
                                        {
                                            "custom_key": [],
                                            "forwarded_ip_config": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        },
                        {
                            "action": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [
                                {
                                    "count": [],
                                    "none": [
                                        {}
                                    ]
                                }
                            ],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [
                                        {
                                            "managed_rule_group_configs": [],
                                            "rule_action_override": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        },
                        {
                            "action": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [
                                {
                                    "count": [],
                                    "none": [
                                        {}
                                    ]
                                }
                            ],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [
                                        {
                                            "managed_rule_group_configs": [],
                                            "rule_action_override": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        }
                    ],
                    "tags": {},
                    "tags_all": {},
                    "visibility_config": [
                        {}
                    ]
                },
                "before_sensitive": false,
                "after_sensitive": {
                    "association_config": [],
                    "captcha_config": [],
                    "challenge_config": [],
                    "custom_response_body": [],
                    "data_protection_config": [],
                    "default_action": [
                        {
                            "allow": [
                                {
                                    "custom_request_handling": []
                                }
                            ],
                            "block": []
                        }
                    ],
                    "rule": [
                        {
                            "action": [
                                {
                                    "allow": [],
                                    "block": [
                                        {
                                            "custom_response": []
                                        }
                                    ],
                                    "captcha": [],
                                    "challenge": [],
                                    "count": []
                                }
                            ],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [
                                        {
                                            "custom_key": [],
                                            "forwarded_ip_config": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        },
                        {
                            "action": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [
                                {
                                    "count": [],
                                    "none": [
                                        {}
                                    ]
                                }
                            ],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [
                                        {
                                            "managed_rule_group_configs": [],
                                            "rule_action_override": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        },
                        {
                            "action": [],
                            "captcha_config": [],
                            "challenge_config": [],
                            "override_action": [
                                {
                                    "count": [],
                                    "none": [
                                        {}
                                    ]
                                }
                            ],
                            "rule_label": [],
                            "statement": [
                                {
                                    "and_statement": [],
                                    "asn_match_statement": [],
                                    "byte_match_statement": [],
                                    "geo_match_statement": [],
                                    "ip_set_reference_statement": [],
                                    "label_match_statement": [],
                                    "managed_rule_group_statement": [
                                        {
                                            "managed_rule_group_configs": [],
                                            "rule_action_override": [],
                                            "scope_down_statement": []
                                        }
                                    ],
                                    "not_statement": [],
                                    "or_statement": [],
                                    "rate_based_statement": [],
                                    "regex_match_statement": [],
                                    "regex_pattern_set_reference_statement": [],
                                    "rule_group_reference_statement": [],
                                    "size_constraint_statement": [],
                                    "sqli_match_statement": [],
                                    "xss_match_statement": []
                                }
                            ],
                            "visibility_config": [
                                {}
                            ]
                        }
                    ],
                    "tags": {},
                    "tags_all": {},
                    "visibility_config": [
                        {}
                    ]
                }
            }
        },
        {
            "address": "aws_wafv2_web_acl_association.alb",
            "mode": "managed",
            "type": "aws_wafv2_web_acl_association",
            "name": "alb",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "actions": [
                    "create"
                ],
                "before": null,
                "after": {
                    "timeouts": null,
                    "id": true,
                    "resource_arn": true,
                    "web_acl_arn": true,
                    "module": "main"
                },
                "after_unknown": {
                    "id": true,
                    "resource_arn": true,
                    "web_acl_arn": true
                },
                "before_sensitive": false,
                "after_sensitive": {}
            }
        }
    ],
    "tfgraph": {
        "name": "G",
        "directed": true,
        "strict": false,
        "rankdir": "RL",
        "_subgraph_cnt": 0,
        "objects": [
            {
                "_gvid": 0,
                "name": "aws_internet_gateway.main",
                "fontname": "sans-serif",
                "label": "aws_internet_gateway.main",
                "shape": "rect"
            },
            {
                "_gvid": 1,
                "name": "aws_lb.main",
                "fontname": "sans-serif",
                "label": "aws_lb.main",
                "shape": "rect"
            },
            {
                "_gvid": 2,
                "name": "aws_lb_listener.http",
                "fontname": "sans-serif",
                "label": "aws_lb_listener.http",
                "shape": "rect"
            },
            {
                "_gvid": 3,
                "name": "aws_lb_target_group.main",
                "fontname": "sans-serif",
                "label": "aws_lb_target_group.main",
                "shape": "rect"
            },
            {
                "_gvid": 4,
                "name": "aws_route_table.public",
                "fontname": "sans-serif",
                "label": "aws_route_table.public",
                "shape": "rect"
            },
            {
                "_gvid": 5,
                "name": "aws_route_table_association.public_a",
                "fontname": "sans-serif",
                "label": "aws_route_table_association.public_a",
                "shape": "rect"
            },
            {
                "_gvid": 6,
                "name": "aws_route_table_association.public_b",
                "fontname": "sans-serif",
                "label": "aws_route_table_association.public_b",
                "shape": "rect"
            },
            {
                "_gvid": 7,
                "name": "aws_security_group.alb",
                "fontname": "sans-serif",
                "label": "aws_security_group.alb",
                "shape": "rect"
            },
            {
                "_gvid": 8,
                "name": "aws_subnet.public_a",
                "fontname": "sans-serif",
                "label": "aws_subnet.public_a",
                "shape": "rect"
            },
            {
                "_gvid": 9,
                "name": "aws_subnet.public_b",
                "fontname": "sans-serif",
                "label": "aws_subnet.public_b",
                "shape": "rect"
            },
            {
                "_gvid": 10,
                "name": "aws_vpc.main",
                "fontname": "sans-serif",
                "label": "aws_vpc.main",
                "shape": "rect"
            },
            {
                "_gvid": 11,
                "name": "aws_wafv2_web_acl.alb",
                "fontname": "sans-serif",
                "label": "aws_wafv2_web_acl.alb",
                "shape": "rect"
            },
            {
                "_gvid": 12,
                "name": "aws_wafv2_web_acl_association.alb",
                "fontname": "sans-serif",
                "label": "aws_wafv2_web_acl_association.alb",
                "shape": "rect"
            }
        ],
        "edges": [
            {
                "_gvid": 0,
                "tail": 0,
                "head": 10
            },
            {
                "_gvid": 1,
                "tail": 1,
                "head": 7
            },
            {
                "_gvid": 2,
                "tail": 1,
                "head": 8
            },
            {
                "_gvid": 3,
                "tail": 1,
                "head": 9
            },
            {
                "_gvid": 4,
                "tail": 2,
                "head": 1
            },
            {
                "_gvid": 5,
                "tail": 2,
                "head": 3
            },
            {
                "_gvid": 6,
                "tail": 3,
                "head": 10
            },
            {
                "_gvid": 7,
                "tail": 4,
                "head": 0
            },
            {
                "_gvid": 8,
                "tail": 5,
                "head": 4
            },
            {
                "_gvid": 9,
                "tail": 5,
                "head": 8
            },
            {
                "_gvid": 10,
                "tail": 6,
                "head": 4
            },
            {
                "_gvid": 11,
                "tail": 6,
                "head": 9
            },
            {
                "_gvid": 12,
                "tail": 7,
                "head": 10
            },
            {
                "_gvid": 13,
                "tail": 8,
                "head": 10
            },
            {
                "_gvid": 14,
                "tail": 9,
                "head": 10
            },
            {
                "_gvid": 15,
                "tail": 12,
                "head": 1
            },
            {
                "_gvid": 16,
                "tail": 12,
                "head": 11
            }
        ]
    },
    "graphdict": {
        "aws_internet_gateway.main": [
            "aws_route_table.public"
        ],
        "aws_lb.main": [
            "aws_lb_listener.http",
            "aws_wafv2_web_acl_association.alb"
        ],
        "aws_lb_listener.http": [],
        "aws_lb_target_group.main": [
            "aws_lb_listener.http"
        ],
        "aws_route_table.public": [
            "aws_route_table_association.public_a",
            "aws_route_table_association.public_b"
        ],
        "aws_route_table_association.public_a": [],
        "aws_route_table_association.public_b": [],
        "aws_security_group.alb": [
            "aws_lb.main"
        ],
        "aws_subnet.public_a": [
            "aws_lb.main",
            "aws_route_table_association.public_a"
        ],
        "aws_subnet.public_b": [
            "aws_lb.main",
            "aws_route_table_association.public_b"
        ],
        "aws_vpc.main": [
            "aws_internet_gateway.main",
            "aws_lb_target_group.main",
            "aws_security_group.alb",
            "aws_subnet.public_a",
            "aws_subnet.public_b"
        ],
        "aws_wafv2_web_acl.alb": [
            "aws_wafv2_web_acl_association.alb"
        ],
        "aws_wafv2_web_acl_association.alb": []
    },
    "meta_data": {
        "aws_internet_gateway.main": {
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "id": true,
            "owner_id": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_lb.main": {
            "access_logs": [],
            "client_keep_alive": 3600,
            "connection_logs": [],
            "customer_owned_ipv4_pool": null,
            "desync_mitigation_mode": "defensive",
            "dns_record_client_routing_policy": null,
            "drop_invalid_header_fields": false,
            "enable_cross_zone_load_balancing": null,
            "enable_deletion_protection": false,
            "enable_http2": true,
            "enable_tls_version_and_cipher_suite_headers": false,
            "enable_waf_fail_open": false,
            "enable_xff_client_port": false,
            "enable_zonal_shift": false,
            "idle_timeout": 60,
            "internal": false,
            "ipam_pools": [],
            "load_balancer_type": "application",
            "minimum_load_balancer_capacity": [],
            "name": "waf-protected-alb",
            "preserve_host_header": false,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "xff_header_processing_mode": "append",
            "arn": true,
            "arn_suffix": true,
            "dns_name": true,
            "enforce_security_group_inbound_rules_on_private_link_traffic": true,
            "id": true,
            "ip_address_type": true,
            "name_prefix": true,
            "security_groups": [],
            "subnet_mapping": [],
            "subnets": [],
            "vpc_id": true,
            "zone_id": true,
            "module": "main"
        },
        "aws_lb_listener.http": {
            "alpn_policy": null,
            "certificate_arn": null,
            "default_action": [
                {
                    "authenticate_cognito": [],
                    "authenticate_oidc": [],
                    "fixed_response": [],
                    "forward": [],
                    "redirect": []
                }
            ],
            "port": 80,
            "protocol": "HTTP",
            "tags": null,
            "timeouts": null,
            "arn": true,
            "id": true,
            "load_balancer_arn": true,
            "mutual_authentication": [],
            "routing_http_request_x_amzn_mtls_clientcert_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_issuer_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_leaf_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_subject_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_validity_header_name": true,
            "routing_http_request_x_amzn_tls_cipher_suite_header_name": true,
            "routing_http_request_x_amzn_tls_version_header_name": true,
            "routing_http_response_access_control_allow_credentials_header_value": true,
            "routing_http_response_access_control_allow_headers_header_value": true,
            "routing_http_response_access_control_allow_methods_header_value": true,
            "routing_http_response_access_control_allow_origin_header_value": true,
            "routing_http_response_access_control_expose_headers_header_value": true,
            "routing_http_response_access_control_max_age_header_value": true,
            "routing_http_response_content_security_policy_header_value": true,
            "routing_http_response_server_enabled": true,
            "routing_http_response_strict_transport_security_header_value": true,
            "routing_http_response_x_content_type_options_header_value": true,
            "routing_http_response_x_frame_options_header_value": true,
            "ssl_policy": true,
            "tags_all": {},
            "tcp_idle_timeout_seconds": true,
            "module": "main"
        },
        "aws_lb_target_group.main": {
            "deregistration_delay": "300",
            "health_check": [
                {}
            ],
            "lambda_multi_value_headers_enabled": false,
            "name": "waf-alb-targets",
            "port": 80,
            "protocol": "HTTP",
            "proxy_protocol_v2": false,
            "slow_start": 0,
            "tags": {},
            "tags_all": {},
            "target_type": "instance",
            "arn": true,
            "arn_suffix": true,
            "connection_termination": true,
            "id": true,
            "ip_address_type": true,
            "load_balancer_arns": [],
            "load_balancing_algorithm_type": true,
            "load_balancing_anomaly_mitigation": true,
            "load_balancing_cross_zone_enabled": true,
            "name_prefix": true,
            "preserve_client_ip": true,
            "protocol_version": true,
            "stickiness": [],
            "target_failover": [],
            "target_group_health": [],
            "target_health_state": [],
            "vpc_id": true,
            "module": "main"
        },
        "aws_route_table.public": {
            "route": [
                {}
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "id": true,
            "owner_id": true,
            "propagating_vgws": [],
            "vpc_id": true,
            "module": "main"
        },
        "aws_route_table_association.public_a": {
            "gateway_id": null,
            "timeouts": null,
            "id": true,
            "route_table_id": true,
            "subnet_id": true,
            "module": "main"
        },
        "aws_route_table_association.public_b": {
            "gateway_id": null,
            "timeouts": null,
            "id": true,
            "route_table_id": true,
            "subnet_id": true,
            "module": "main"
        },
        "aws_security_group.alb": {
            "description": "Security group for ALB with WAF",
            "egress": [
                {
                    "cidr_blocks": [
                        false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                }
            ],
            "ingress": [
                {
                    "cidr_blocks": [
                        false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                },
                {
                    "cidr_blocks": [
                        false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                }
            ],
            "name": "waf-alb-sg",
            "revoke_rules_on_delete": false,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "id": true,
            "name_prefix": true,
            "owner_id": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_subnet.public_a": {
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "us-west-2a",
            "cidr_block": "10.0.1.0/24",
            "customer_owned_ipv4_pool": null,
            "enable_dns64": false,
            "enable_lni_at_device_index": null,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "ipv6_cidr_block": null,
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": null,
            "map_public_ip_on_launch": true,
            "outpost_arn": null,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "availability_zone_id": true,
            "id": true,
            "ipv6_cidr_block_association_id": true,
            "owner_id": true,
            "private_dns_hostname_type_on_launch": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_subnet.public_b": {
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "us-west-2b",
            "cidr_block": "10.0.2.0/24",
            "customer_owned_ipv4_pool": null,
            "enable_dns64": false,
            "enable_lni_at_device_index": null,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "ipv6_cidr_block": null,
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": null,
            "map_public_ip_on_launch": true,
            "outpost_arn": null,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "availability_zone_id": true,
            "id": true,
            "ipv6_cidr_block_association_id": true,
            "owner_id": true,
            "private_dns_hostname_type_on_launch": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_vpc.main": {
            "assign_generated_ipv6_cidr_block": null,
            "cidr_block": "10.0.0.0/16",
            "enable_dns_hostnames": true,
            "enable_dns_support": true,
            "instance_tenancy": "default",
            "ipv4_ipam_pool_id": null,
            "ipv4_netmask_length": null,
            "ipv6_ipam_pool_id": null,
            "ipv6_netmask_length": null,
            "tags": {},
            "tags_all": {},
            "arn": true,
            "default_network_acl_id": true,
            "default_route_table_id": true,
            "default_security_group_id": true,
            "dhcp_options_id": true,
            "enable_network_address_usage_metrics": true,
            "id": true,
            "ipv6_association_id": true,
            "ipv6_cidr_block": true,
            "ipv6_cidr_block_network_border_group": true,
            "main_route_table_id": true,
            "owner_id": true,
            "module": "main"
        },
        "aws_wafv2_web_acl.alb": {
            "association_config": [],
            "captcha_config": [],
            "challenge_config": [],
            "custom_response_body": [],
            "data_protection_config": [],
            "default_action": [
                {
                    "allow": [
                        {
                            "custom_request_handling": []
                        }
                    ],
                    "block": []
                }
            ],
            "description": null,
            "name": "alb-web-acl",
            "rule": [
                {
                    "action": [
                        {
                            "allow": [],
                            "block": [
                                {
                                    "custom_response": []
                                }
                            ],
                            "captcha": [],
                            "challenge": [],
                            "count": []
                        }
                    ],
                    "captcha_config": [],
                    "challenge_config": [],
                    "override_action": [],
                    "rule_label": [],
                    "statement": [
                        {
                            "and_statement": [],
                            "asn_match_statement": [],
                            "byte_match_statement": [],
                            "geo_match_statement": [],
                            "ip_set_reference_statement": [],
                            "label_match_statement": [],
                            "managed_rule_group_statement": [],
                            "not_statement": [],
                            "or_statement": [],
                            "rate_based_statement": [
                                {
                                    "custom_key": [],
                                    "forwarded_ip_config": [],
                                    "scope_down_statement": []
                                }
                            ],
                            "regex_match_statement": [],
                            "regex_pattern_set_reference_statement": [],
                            "rule_group_reference_statement": [],
                            "size_constraint_statement": [],
                            "sqli_match_statement": [],
                            "xss_match_statement": []
                        }
                    ],
                    "visibility_config": [
                        {}
                    ]
                },
                {
                    "action": [],
                    "captcha_config": [],
                    "challenge_config": [],
                    "override_action": [
                        {
                            "count": [],
                            "none": [
                                {}
                            ]
                        }
                    ],
                    "rule_label": [],
                    "statement": [
                        {
                            "and_statement": [],
                            "asn_match_statement": [],
                            "byte_match_statement": [],
                            "geo_match_statement": [],
                            "ip_set_reference_statement": [],
                            "label_match_statement": [],
                            "managed_rule_group_statement": [
                                {
                                    "managed_rule_group_configs": [],
                                    "rule_action_override": [],
                                    "scope_down_statement": []
                                }
                            ],
                            "not_statement": [],
                            "or_statement": [],
                            "rate_based_statement": [],
                            "regex_match_statement": [],
                            "regex_pattern_set_reference_statement": [],
                            "rule_group_reference_statement": [],
                            "size_constraint_statement": [],
                            "sqli_match_statement": [],
                            "xss_match_statement": []
                        }
                    ],
                    "visibility_config": [
                        {}
                    ]
                },
                {
                    "action": [],
                    "captcha_config": [],
                    "challenge_config": [],
                    "override_action": [
                        {
                            "count": [],
                            "none": [
                                {}
                            ]
                        }
                    ],
                    "rule_label": [],
                    "statement": [
                        {
                            "and_statement": [],
                            "asn_match_statement": [],
                            "byte_match_statement": [],
                            "geo_match_statement": [],
                            "ip_set_reference_statement": [],
                            "label_match_statement": [],
                            "managed_rule_group_statement": [
                                {
                                    "managed_rule_group_configs": [],
                                    "rule_action_override": [],
                                    "scope_down_statement": []
                                }
                            ],
                            "not_statement": [],
                            "or_statement": [],
                            "rate_based_statement": [],
                            "regex_match_statement": [],
                            "regex_pattern_set_reference_statement": [],
                            "rule_group_reference_statement": [],
                            "size_constraint_statement": [],
                            "sqli_match_statement": [],
                            "xss_match_statement": []
                        }
                    ],
                    "visibility_config": [
                        {}
                    ]
                }
            ],
            "rule_json": null,
            "scope": "REGIONAL",
            "tags": {},
            "tags_all": {},
            "token_domains": null,
            "visibility_config": [
                {}
            ],
            "application_integration_url": true,
            "arn": true,
            "capacity": true,
            "id": true,
            "lock_token": true,
            "name_prefix": true,
            "module": "main"
        },
        "aws_wafv2_web_acl_association.alb": {
            "timeouts": null,
            "id": true,
            "resource_arn": true,
            "web_acl_arn": true,
            "module": "main"
        }
    },
    "all_output": {
        "tests/fixtures/aws_terraform/waf_alb/main.tf": [
            {
                "waf_arn": {
                    "value": "${aws_wafv2_web_acl.alb.arn}",
                    "description": "WAF WebACL ARN"
                }
            },
            {
                "alb_dns": {
                    "value": "${aws_lb.main.dns_name}",
                    "description": "ALB DNS name"
                }
            },
            {
                "waf_association": {
                    "value": "${aws_wafv2_web_acl_association.alb.id}",
                    "description": "WAF association ID"
                }
            }
        ]
    },
    "node_list": [
        "aws_internet_gateway.main",
        "aws_lb.main",
        "aws_lb_listener.http",
        "aws_lb_target_group.main",
        "aws_route_table.public",
        "aws_route_table_association.public_a",
        "aws_route_table_association.public_b",
        "aws_security_group.alb",
        "aws_subnet.public_a",
        "aws_subnet.public_b",
        "aws_vpc.main",
        "aws_wafv2_web_acl.alb",
        "aws_wafv2_web_acl_association.alb"
    ],
    "hidden": [
        "aws_security_group_rule"
    ],
    "annotations": {},
    "original_graphdict": {
        "aws_internet_gateway.main": [
            "aws_route_table.public"
        ],
        "aws_lb.main": [
            "aws_lb_listener.http",
            "aws_wafv2_web_acl_association.alb"
        ],
        "aws_lb_listener.http": [],
        "aws_lb_target_group.main": [
            "aws_lb_listener.http"
        ],
        "aws_route_table.public": [
            "aws_route_table_association.public_a",
            "aws_route_table_association.public_b"
        ],
        "aws_route_table_association.public_a": [],
        "aws_route_table_association.public_b": [],
        "aws_security_group.alb": [
            "aws_lb.main"
        ],
        "aws_subnet.public_a": [
            "aws_lb.main",
            "aws_route_table_association.public_a"
        ],
        "aws_subnet.public_b": [
            "aws_lb.main",
            "aws_route_table_association.public_b"
        ],
        "aws_vpc.main": [
            "aws_internet_gateway.main",
            "aws_lb_target_group.main",
            "aws_security_group.alb",
            "aws_subnet.public_a",
            "aws_subnet.public_b"
        ],
        "aws_wafv2_web_acl.alb": [
            "aws_wafv2_web_acl_association.alb"
        ],
        "aws_wafv2_web_acl_association.alb": []
    },
    "original_metadata": {
        "aws_internet_gateway.main": {
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "id": true,
            "owner_id": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_lb.main": {
            "access_logs": [],
            "client_keep_alive": 3600,
            "connection_logs": [],
            "customer_owned_ipv4_pool": null,
            "desync_mitigation_mode": "defensive",
            "dns_record_client_routing_policy": null,
            "drop_invalid_header_fields": false,
            "enable_cross_zone_load_balancing": null,
            "enable_deletion_protection": false,
            "enable_http2": true,
            "enable_tls_version_and_cipher_suite_headers": false,
            "enable_waf_fail_open": false,
            "enable_xff_client_port": false,
            "enable_zonal_shift": false,
            "idle_timeout": 60,
            "internal": false,
            "ipam_pools": [],
            "load_balancer_type": "application",
            "minimum_load_balancer_capacity": [],
            "name": "waf-protected-alb",
            "preserve_host_header": false,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "xff_header_processing_mode": "append",
            "arn": true,
            "arn_suffix": true,
            "dns_name": true,
            "enforce_security_group_inbound_rules_on_private_link_traffic": true,
            "id": true,
            "ip_address_type": true,
            "name_prefix": true,
            "security_groups": [],
            "subnet_mapping": [],
            "subnets": [],
            "vpc_id": true,
            "zone_id": true,
            "module": "main"
        },
        "aws_lb_listener.http": {
            "alpn_policy": null,
            "certificate_arn": null,
            "default_action": [
                {
                    "authenticate_cognito": [],
                    "authenticate_oidc": [],
                    "fixed_response": [],
                    "forward": [],
                    "redirect": []
                }
            ],
            "port": 80,
            "protocol": "HTTP",
            "tags": null,
            "timeouts": null,
            "arn": true,
            "id": true,
            "load_balancer_arn": true,
            "mutual_authentication": [],
            "routing_http_request_x_amzn_mtls_clientcert_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_issuer_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_leaf_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_subject_header_name": true,
            "routing_http_request_x_amzn_mtls_clientcert_validity_header_name": true,
            "routing_http_request_x_amzn_tls_cipher_suite_header_name": true,
            "routing_http_request_x_amzn_tls_version_header_name": true,
            "routing_http_response_access_control_allow_credentials_header_value": true,
            "routing_http_response_access_control_allow_headers_header_value": true,
            "routing_http_response_access_control_allow_methods_header_value": true,
            "routing_http_response_access_control_allow_origin_header_value": true,
            "routing_http_response_access_control_expose_headers_header_value": true,
            "routing_http_response_access_control_max_age_header_value": true,
            "routing_http_response_content_security_policy_header_value": true,
            "routing_http_response_server_enabled": true,
            "routing_http_response_strict_transport_security_header_value": true,
            "routing_http_response_x_content_type_options_header_value": true,
            "routing_http_response_x_frame_options_header_value": true,
            "ssl_policy": true,
            "tags_all": {},
            "tcp_idle_timeout_seconds": true,
            "module": "main"
        },
        "aws_lb_target_group.main": {
            "deregistration_delay": "300",
            "health_check": [
                {}
            ],
            "lambda_multi_value_headers_enabled": false,
            "name": "waf-alb-targets",
            "port": 80,
            "protocol": "HTTP",
            "proxy_protocol_v2": false,
            "slow_start": 0,
            "tags": {},
            "tags_all": {},
            "target_type": "instance",
            "arn": true,
            "arn_suffix": true,
            "connection_termination": true,
            "id": true,
            "ip_address_type": true,
            "load_balancer_arns": [],
            "load_balancing_algorithm_type": true,
            "load_balancing_anomaly_mitigation": true,
            "load_balancing_cross_zone_enabled": true,
            "name_prefix": true,
            "preserve_client_ip": true,
            "protocol_version": true,
            "stickiness": [],
            "target_failover": [],
            "target_group_health": [],
            "target_health_state": [],
            "vpc_id": true,
            "module": "main"
        },
        "aws_route_table.public": {
            "route": [
                {}
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "id": true,
            "owner_id": true,
            "propagating_vgws": [],
            "vpc_id": true,
            "module": "main"
        },
        "aws_route_table_association.public_a": {
            "gateway_id": null,
            "timeouts": null,
            "id": true,
            "route_table_id": true,
            "subnet_id": true,
            "module": "main"
        },
        "aws_route_table_association.public_b": {
            "gateway_id": null,
            "timeouts": null,
            "id": true,
            "route_table_id": true,
            "subnet_id": true,
            "module": "main"
        },
        "aws_security_group.alb": {
            "description": "Security group for ALB with WAF",
            "egress": [
                {
                    "cidr_blocks": [
                        false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                }
            ],
            "ingress": [
                {
                    "cidr_blocks": [
                        false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                },
                {
                    "cidr_blocks": [
                        false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                }
            ],
            "name": "waf-alb-sg",
            "revoke_rules_on_delete": false,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "id": true,
            "name_prefix": true,
            "owner_id": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_subnet.public_a": {
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "us-west-2a",
            "cidr_block": "10.0.1.0/24",
            "customer_owned_ipv4_pool": null,
            "enable_dns64": false,
            "enable_lni_at_device_index": null,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "ipv6_cidr_block": null,
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": null,
            "map_public_ip_on_launch": true,
            "outpost_arn": null,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "availability_zone_id": true,
            "id": true,
            "ipv6_cidr_block_association_id": true,
            "owner_id": true,
            "private_dns_hostname_type_on_launch": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_subnet.public_b": {
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "us-west-2b",
            "cidr_block": "10.0.2.0/24",
            "customer_owned_ipv4_pool": null,
            "enable_dns64": false,
            "enable_lni_at_device_index": null,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "ipv6_cidr_block": null,
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": null,
            "map_public_ip_on_launch": true,
            "outpost_arn": null,
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "arn": true,
            "availability_zone_id": true,
            "id": true,
            "ipv6_cidr_block_association_id": true,
            "owner_id": true,
            "private_dns_hostname_type_on_launch": true,
            "vpc_id": true,
            "module": "main"
        },
        "aws_vpc.main": {
            "assign_generated_ipv6_cidr_block": null,
            "cidr_block": "10.0.0.0/16",
            "enable_dns_hostnames": true,
            "enable_dns_support": true,
            "instance_tenancy": "default",
            "ipv4_ipam_pool_id": null,
            "ipv4_netmask_length": null,
            "ipv6_ipam_pool_id": null,
            "ipv6_netmask_length": null,
            "tags": {},
            "tags_all": {},
            "arn": true,
            "default_network_acl_id": true,
            "default_route_table_id": true,
            "default_security_group_id": true,
            "dhcp_options_id": true,
            "enable_network_address_usage_metrics": true,
            "id": true,
            "ipv6_association_id": true,
            "ipv6_cidr_block": true,
            "ipv6_cidr_block_network_border_group": true,
            "main_route_table_id": true,
            "owner_id": true,
            "module": "main"
        },
        "aws_wafv2_web_acl.alb": {
            "association_config": [],
            "captcha_config": [],
            "challenge_config": [],
            "custom_response_body": [],
            "data_protection_config": [],
            "default_action": [
                {
                    "allow": [
                        {
                            "custom_request_handling": []
                        }
                    ],
                    "block": []
                }
            ],
            "description": null,
            "name": "alb-web-acl",
            "rule": [
                {
                    "action": [
                        {
                            "allow": [],
                            "block": [
                                {
                                    "custom_response": []
                                }
                            ],
                            "captcha": [],
                            "challenge": [],
                            "count": []
                        }
                    ],
                    "captcha_config": [],
                    "challenge_config": [],
                    "override_action": [],
                    "rule_label": [],
                    "statement": [
                        {
                            "and_statement": [],
                            "asn_match_statement": [],
                            "byte_match_statement": [],
                            "geo_match_statement": [],
                            "ip_set_reference_statement": [],
                            "label_match_statement": [],
                            "managed_rule_group_statement": [],
                            "not_statement": [],
                            "or_statement": [],
                            "rate_based_statement": [
                                {
                                    "custom_key": [],
                                    "forwarded_ip_config": [],
                                    "scope_down_statement": []
                                }
                            ],
                            "regex_match_statement": [],
                            "regex_pattern_set_reference_statement": [],
                            "rule_group_reference_statement": [],
                            "size_constraint_statement": [],
                            "sqli_match_statement": [],
                            "xss_match_statement": []
                        }
                    ],
                    "visibility_config": [
                        {}
                    ]
                },
                {
                    "action": [],
                    "captcha_config": [],
                    "challenge_config": [],
                    "override_action": [
                        {
                            "count": [],
                            "none": [
                                {}
                            ]
                        }
                    ],
                    "rule_label": [],
                    "statement": [
                        {
                            "and_statement": [],
                            "asn_match_statement": [],
                            "byte_match_statement": [],
                            "geo_match_statement": [],
                            "ip_set_reference_statement": [],
                            "label_match_statement": [],
                            "managed_rule_group_statement": [
                                {
                                    "managed_rule_group_configs": [],
                                    "rule_action_override": [],
                                    "scope_down_statement": []
                                }
                            ],
                            "not_statement": [],
                            "or_statement": [],
                            "rate_based_statement": [],
                            "regex_match_statement": [],
                            "regex_pattern_set_reference_statement": [],
                            "rule_group_reference_statement": [],
                            "size_constraint_statement": [],
                            "sqli_match_statement": [],
                            "xss_match_statement": []
                        }
                    ],
                    "visibility_config": [
                        {}
                    ]
                },
                {
                    "action": [],
                    "captcha_config": [],
                    "challenge_config": [],
                    "override_action": [
                        {
                            "count": [],
                            "none": [
                                {}
                            ]
                        }
                    ],
                    "rule_label": [],
                    "statement": [
                        {
                            "and_statement": [],
                            "asn_match_statement": [],
                            "byte_match_statement": [],
                            "geo_match_statement": [],
                            "ip_set_reference_statement": [],
                            "label_match_statement": [],
                            "managed_rule_group_statement": [
                                {
                                    "managed_rule_group_configs": [],
                                    "rule_action_override": [],
                                    "scope_down_statement": []
                                }
                            ],
                            "not_statement": [],
                            "or_statement": [],
                            "rate_based_statement": [],
                            "regex_match_statement": [],
                            "regex_pattern_set_reference_statement": [],
                            "rule_group_reference_statement": [],
                            "size_constraint_statement": [],
                            "sqli_match_statement": [],
                            "xss_match_statement": []
                        }
                    ],
                    "visibility_config": [
                        {}
                    ]
                }
            ],
            "rule_json": null,
            "scope": "REGIONAL",
            "tags": {},
            "tags_all": {},
            "token_domains": null,
            "visibility_config": [
                {}
            ],
            "application_integration_url": true,
            "arn": true,
            "capacity": true,
            "id": true,
            "lock_token": true,
            "name_prefix": true,
            "module": "main"
        },
        "aws_wafv2_web_acl_association.alb": {
            "timeouts": null,
            "id": true,
            "resource_arn": true,
            "web_acl_arn": true,
            "module": "main"
        }
    },
    "module_source_dict": {},
    "all_resource": {
        "tests/fixtures/aws_terraform/waf_alb/main.tf": [
            {
                "aws_vpc": {
                    "main": {
                        "cidr_block": "10.0.0.0/16",
                        "enable_dns_hostnames": true,
                        "enable_dns_support": true,
                        "tags": {
                            "Name": "waf-alb-test-vpc"
                        }
                    }
                }
            },
            {
                "aws_subnet": {
                    "public_a": {
                        "vpc_id": "${aws_vpc.main.id}",
                        "cidr_block": "10.0.1.0/24",
                        "availability_zone": "us-west-2a",
                        "map_public_ip_on_launch": true,
                        "tags": {
                            "Name": "waf-alb-public-a"
                        }
                    }
                }
            },
            {
                "aws_subnet": {
                    "public_b": {
                        "vpc_id": "${aws_vpc.main.id}",
                        "cidr_block": "10.0.2.0/24",
                        "availability_zone": "us-west-2b",
                        "map_public_ip_on_launch": true,
                        "tags": {
                            "Name": "waf-alb-public-b"
                        }
                    }
                }
            },
            {
                "aws_internet_gateway": {
                    "main": {
                        "vpc_id": "${aws_vpc.main.id}",
                        "tags": {
                            "Name": "waf-alb-igw"
                        }
                    }
                }
            },
            {
                "aws_route_table": {
                    "public": {
                        "vpc_id": "${aws_vpc.main.id}",
                        "route": [
                            {
                                "cidr_block": "0.0.0.0/0",
                                "gateway_id": "${aws_internet_gateway.main.id}"
                            }
                        ],
                        "tags": {
                            "Name": "waf-alb-public-rt"
                        }
                    }
                }
            },
            {
                "aws_route_table_association": {
                    "public_a": {
                        "subnet_id": "${aws_subnet.public_a.id}",
                        "route_table_id": "${aws_route_table.public.id}"
                    }
                }
            },
            {
                "aws_route_table_association": {
                    "public_b": {
                        "subnet_id": "${aws_subnet.public_b.id}",
                        "route_table_id": "${aws_route_table.public.id}"
                    }
                }
            },
            {
                "aws_security_group": {
                    "alb": {
                        "name": "waf-alb-sg",
                        "description": "Security group for ALB with WAF",
                        "vpc_id": "${aws_vpc.main.id}",
                        "ingress": [
                            {
                                "description": "HTTPS from anywhere",
                                "from_port": 443,
                                "to_port": 443,
                                "protocol": "tcp",
                                "cidr_blocks": [
                                    "0.0.0.0/0"
                                ]
                            },
                            {
                                "description": "HTTP from anywhere",
                                "from_port": 80,
                                "to_port": 80,
                                "protocol": "tcp",
                                "cidr_blocks": [
                                    "0.0.0.0/0"
                                ]
                            }
                        ],
                        "egress": [
                            {
                                "description": "All outbound traffic",
                                "from_port": 0,
                                "to_port": 0,
                                "protocol": "-1",
                                "cidr_blocks": [
                                    "0.0.0.0/0"
                                ]
                            }
                        ],
                        "tags": {
                            "Name": "waf-alb-sg"
                        }
                    }
                }
            },
            {
                "aws_lb": {
                    "main": {
                        "name": "waf-protected-alb",
                        "internal": false,
                        "load_balancer_type": "application",
                        "security_groups": [
                            "${aws_security_group.alb.id}"
                        ],
                        "subnets": [
                            "${aws_subnet.public_a.id}",
                            "${aws_subnet.public_b.id}"
                        ],
                        "enable_deletion_protection": false,
                        "tags": {
                            "Name": "waf-protected-alb"
                        }
                    }
                }
            },
            {
                "aws_lb_target_group": {
                    "main": {
                        "name": "waf-alb-targets",
                        "port": 80,
                        "protocol": "HTTP",
                        "vpc_id": "${aws_vpc.main.id}",
                        "health_check": [
                            {
                                "enabled": true,
                                "healthy_threshold": 2,
                                "interval": 30,
                                "matcher": "200",
                                "path": "/",
                                "port": "traffic-port",
                                "protocol": "HTTP",
                                "timeout": 5,
                                "unhealthy_threshold": 2
                            }
                        ],
                        "tags": {
                            "Name": "waf-alb-targets"
                        }
                    }
                }
            },
            {
                "aws_lb_listener": {
                    "http": {
                        "load_balancer_arn": "${aws_lb.main.arn}",
                        "port": "80",
                        "protocol": "HTTP",
                        "default_action": [
                            {
                                "type": "forward",
                                "target_group_arn": "${aws_lb_target_group.main.arn}"
                            }
                        ]
                    }
                }
            },
            {
                "aws_wafv2_web_acl": {
                    "alb": {
                        "name": "alb-web-acl",
                        "scope": "REGIONAL",
                        "default_action": [
                            {
                                "allow": [
                                    {}
                                ]
                            }
                        ],
                        "rule": [
                            {
                                "name": "sql-injection-rule",
                                "priority": 1,
                                "override_action": [
                                    {
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "statement": [
                                    {
                                        "managed_rule_group_statement": [
                                            {
                                                "name": "AWSManagedRulesSQLiRuleSet",
                                                "vendor_name": "AWS"
                                            }
                                        ]
                                    }
                                ],
                                "visibility_config": [
                                    {
                                        "cloudwatch_metrics_enabled": true,
                                        "metric_name": "SQLInjectionRule",
                                        "sampled_requests_enabled": true
                                    }
                                ]
                            },
                            {
                                "name": "xss-protection-rule",
                                "priority": 2,
                                "override_action": [
                                    {
                                        "none": [
                                            {}
                                        ]
                                    }
                                ],
                                "statement": [
                                    {
                                        "managed_rule_group_statement": [
                                            {
                                                "name": "AWSManagedRulesKnownBadInputsRuleSet",
                                                "vendor_name": "AWS"
                                            }
                                        ]
                                    }
                                ],
                                "visibility_config": [
                                    {
                                        "cloudwatch_metrics_enabled": true,
                                        "metric_name": "XSSProtectionRule",
                                        "sampled_requests_enabled": true
                                    }
                                ]
                            },
                            {
                                "name": "rate-limit-rule",
                                "priority": 3,
                                "action": [
                                    {
                                        "block": [
                                            {}
                                        ]
                                    }
                                ],
                                "statement": [
                                    {
                                        "rate_based_statement": [
                                            {
                                                "limit": 1000,
                                                "aggregate_key_type": "IP"
                                            }
                                        ]
                                    }
                                ],
                                "visibility_config": [
                                    {
                                        "cloudwatch_metrics_enabled": true,
                                        "metric_name": "RateLimitRule",
                                        "sampled_requests_enabled": true
                                    }
                                ]
                            }
                        ],
                        "visibility_config": [
                            {
                                "cloudwatch_metrics_enabled": true,
                                "metric_name": "ALBWebACL",
                                "sampled_requests_enabled": true
                            }
                        ],
                        "tags": {
                            "Name": "alb-web-acl"
                        }
                    }
                }
            },
            {
                "aws_wafv2_web_acl_association": {
                    "alb": {
                        "resource_arn": "${aws_lb.main.arn}",
                        "web_acl_arn": "${aws_wafv2_web_acl.alb.arn}"
                    }
                }
            }
        ]
    },
    "varfile_list": [],
    "tempdir": "<TemporaryDirectory '/var/folders/tq/0qhyd1tx2mdfyb5wf16r4py40000gn/T/tmp7d6wgzx6'>"
}